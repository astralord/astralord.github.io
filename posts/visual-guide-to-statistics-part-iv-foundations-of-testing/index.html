<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Visual Guide to Statistics. Part IV: Foundations of Testing" /><meta property="og:locale" content="en" /><meta name="description" content="This is the fourth and the last part of a ‘Visual Guide to Statistics’ cycle. All the previous parts and other topics related to statistics could be found here. In this post we will test hypotheses about the unknown parameter $\vartheta$. As before, we have a statistical experiment with sample space $\mathcal{X}$ and family of probability measures $\mathcal{P} = \lbrace P_\vartheta \mid \vartheta \in \Theta \rbrace$." /><meta property="og:description" content="This is the fourth and the last part of a ‘Visual Guide to Statistics’ cycle. All the previous parts and other topics related to statistics could be found here. In this post we will test hypotheses about the unknown parameter $\vartheta$. As before, we have a statistical experiment with sample space $\mathcal{X}$ and family of probability measures $\mathcal{P} = \lbrace P_\vartheta \mid \vartheta \in \Theta \rbrace$." /><link rel="canonical" href="https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/" /><meta property="og:url" content="https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/" /><meta property="og:site_name" content="AstraBlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-01T06:00:00+03:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Visual Guide to Statistics. Part IV: Foundations of Testing" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-03T23:09:13+03:00","datePublished":"2022-05-01T06:00:00+03:00","description":"This is the fourth and the last part of a ‘Visual Guide to Statistics’ cycle. All the previous parts and other topics related to statistics could be found here. In this post we will test hypotheses about the unknown parameter $\\vartheta$. As before, we have a statistical experiment with sample space $\\mathcal{X}$ and family of probability measures $\\mathcal{P} = \\lbrace P_\\vartheta \\mid \\vartheta \\in \\Theta \\rbrace$.","headline":"Visual Guide to Statistics. Part IV: Foundations of Testing","mainEntityOfPage":{"@type":"WebPage","@id":"https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/"},"url":"https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/"}</script><title>Visual Guide to Statistics. Part IV: Foundations of Testing | AstraBlog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="AstraBlog"><meta name="application-name" content="AstraBlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/marvel-icon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">AstraBlog</a></div><div class="site-subtitle font-italic">A place to learn and share knowledge about AI-related things</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/astralord" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['samarin_ad','mail.ru'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/aleksandr-samarin-b8a35496" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://t.me/astrlrd" aria-label="telegram" class="order-6" target="_blank" rel="noopener"> <i class="fab fa-telegram"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Visual Guide to Statistics. Part IV: Foundations of Testing</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Visual Guide to Statistics. Part IV: Foundations of Testing</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Aleksandr Samarin </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, May 1, 2022, 6:00 AM +0300" >May 1, 2022<i class="unloaded">2022-05-01T06:00:00+03:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jul 3, 2023, 11:09 PM +0300" >Jul 3, 2023<i class="unloaded">2023-07-03T23:09:13+03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4154 words">23 min read</span></div></div><div class="post-content"><blockquote><p>This is the fourth and the last part of a ‘Visual Guide to Statistics’ cycle. All the previous parts and other topics related to statistics could be found <a href="https://astralord.github.io/categories/statistics/">here</a>. In this post we will test hypotheses about the unknown parameter $\vartheta$. As before, we have a statistical experiment with sample space $\mathcal{X}$ and family of probability measures $\mathcal{P} = \lbrace P_\vartheta \mid \vartheta \in \Theta \rbrace$.</p></blockquote><h3 id="introductory-example">Introductory example</h3><p>Let’s discuss a simplified clinical study, in which we want to decide whether a newly invented drug $B$ is better than a well-known drug $A$ or not. Suppose that you know from previous years that $A$ has a chance of healing about $p_a$. The new drug $B$ was tested on $n$ persons and $m$ became healthy. Do we choose $A$ or $B$? In terms of mathematics we test</p>\[H\colon p_b \leq p_a \quad \text{vs} \quad K\colon p_b &gt; p_a,\]<p>where $p_b$ is the unknown chance of healing with $B$.</p><p>Let $\Theta = \Theta_H \cup \Theta_K$ be a partition of $\Theta$.</p><ul><li>$\Theta_H$ is called <strong>(null) hypothesis</strong>, $\Theta_K$ is called the <strong>alternative</strong>.<li>A <strong>randomized test</strong> is a measurable map $\varphi: \mathcal{X} \rightarrow [0, 1]$. Here $\varphi(x)$ is the probability of a decision for $\Theta_K$ when $x=X(\omega)$ is observed.<li>For a test $\varphi$ we call $\mathcal{K}= \lbrace x \mid \varphi(x)=1 \rbrace$ the <strong>critical region</strong> and $\mathcal{R}= \lbrace x \mid \varphi(x) \in (0,1) \rbrace$ - the <strong>region of randomization</strong>. A test $\varphi$ is called <strong>non-randomized</strong> if $\mathcal{R} = \emptyset$.</ul><p>In our example we know that the statistic $\overline{X}_n$ is the UMVU estimator for $p$. A reasonable decision rule is to decide for $K$ if $\overline{X}_n$ is “large”. For example,</p>\[\varphi(x) = \left \lbrace \begin{array}{cl} 1, &amp; \overline{X}_n &gt; c, \\ 0, &amp; \overline{X}_n \leq c \end{array} \right.\]<p>with some constant $c$ is a reasonable test. But how “large” must $c$ be?</p><p>When deciding for $H$ or $K$ using $\varphi$, two errors can occur:</p><ul><li><strong>Error of the 1st kind</strong>: decide for $K$ when $H$ is true.<li><strong>Error of the 2nd kind</strong>: decide for $H$ when $K$ is true.</ul><p>Both errors occur with certain probabilities. In our example the probability of a decision for $K$ is</p>\[P(\varphi(X)=1)=P(\overline{X}_n &gt; c).\]<p>In practice, we can use approximation by normal distribution</p>\[\begin{aligned} P(\overline{X}_n &gt; c) &amp; = P\bigg(\frac{\sqrt{n}(\overline{X}_n - p_b)}{\sqrt{p_b(1-p_b)}} &gt; \frac{\sqrt{n}(c - p_b)}{\sqrt{p_b(1-p_b)}}\bigg) \\ \color{Salmon}{\text{Central Limit Theorem} \rightarrow} &amp; \approx P\bigg(\mathcal{N}(0,1) &gt; \frac{\sqrt{n}(c - p_b)}{\sqrt{p_b(1-p_b)}}\bigg) \\&amp; = \Phi\bigg(\frac{\sqrt{n}(p_b - c)}{\sqrt{p_b(1-p_b)}}\bigg), \end{aligned}\]<p>where $\Phi$ is the distribution function of $\mathcal{N}(0, 1)$. The probability of error of the 1st kind is bounded from above:</p>\[\begin{aligned} P(\text{reject } H \mid H \text{ is true}) &amp;= P(\overline{X}_n &gt; c \mid p_b \leq p_a) \\ &amp;\leq P(\overline{X}_n &gt; c \mid p_b = p_a) \\ &amp; =\Phi\bigg(\frac{\sqrt{n}(p_a - c)}{\sqrt{p_a(1-p_a)}}\bigg). \end{aligned}\]<p>By symmetry,</p>\[P(\text{accept } H \mid K \text{ is true}) \leq 1 - \Phi\bigg(\frac{\sqrt{n}(p_a - c)}{\sqrt{p_a(1-p_a)}}\bigg).\] <script src="https://d3js.org/d3.v4.min.js"></script><link href="https://fonts.googleapis.com/css?family=Arvo" rel="stylesheet" /><style> .ticks { font: 10px arvo; } .track, .track-inset, .track-overlay { stroke-linecap: round; } .track { stroke: #000; stroke-opacity: 0.8; stroke-width: 7px; } .track-inset { stroke: #ddd; stroke-width: 5px; } .track-overlay { pointer-events: stroke; stroke-width: 50px; stroke: transparent; } .handle { fill: #fff; stroke: #000; stroke-opacity: 0.8; stroke-width: 1px; } #sample-button-h { top: 15px; left: 15px; background: #65AD69; padding-right: 26px; border-radius: 3px; border: none; color: white; margin: 0; padding: 0 1px; width: 60px; height: 25px; font-family: Arvo; font-size: 11px; } #sample-button-h:hover { background-color: #696969; }#sample-button-k { top: 15px; left: 15px; background: #EDA137; padding-right: 26px; border-radius: 3px; border: none; color: white; margin: 0; padding: 0 1px; width: 60px; height: 25px; font-family: Arvo; font-size: 11px; } #sample-button-k:hover { background-color: #696969; } #sample-button-brt { top: 15px; left: 15px; background: #65AD69; padding-right: 26px; border-radius: 3px; border: none; color: white; margin: 0; padding: 0 1px; width: 60px; height: 25px; font-family: Arvo; font-size: 11px; } #sample-button-brt:hover { background-color: #696969; } #add-button { top: 15px; left: 15px; background: #348ABD; padding-right: 26px; border-radius: 3px; border: none; color: white; margin: 0; padding: 0 1px; width: 60px; height: 25px; font-family: Arvo; font-size: 11px; } #add-button:hover { background-color: #696969; } #reset-button { top: 15px; left: 15px; background: #E86456; padding-right: 26px; border-radius: 3px; border: none; color: white; margin: 0; padding: 0 1px; width: 60px; height: 25px; font-family: Arvo; font-size: 11px; } #reset-button:hover { background-color: #696969; } #reset-button-2 { top: 15px; left: 15px; background: #E86456; padding-right: 26px; border-radius: 3px; border: none; color: white; margin: 0; padding: 0 1px; width: 60px; height: 25px; font-family: Arvo; font-size: 11px; } #reset-button-2:hover { background-color: #696969; } #delete-button { top: 15px; left: 15px; background: #EDA137; padding-right: 26px; border-radius: 3px; border: none; color: white; margin: 0; padding: 0 1px; width: 60px; height: 25px; font-family: Arvo; font-size: 11px; } #delete-button:hover { background-color: #696969; } #n-text { font-family: Arvo; font-size: 11px; } #n-num { font-family: Arvo; font-size: 11px; } }</style><div id="basic_test"></div><script> d3.select("#basic_test") .style("position", "relative"); function erf(x) { if (Math.abs(x) > 3) { return x / Math.abs(x); } var m = 1.00; var s = 1.00; var sum = x * 1.0; for(var i = 1; i < 50; i++){ m *= i; s *= -1; sum += (s * Math.pow(x, 2.0 * i + 1.0)) / (m * (2.0 * i + 1.0)); } return 1.1283791671 * sum; } function Phi(x) { return 0.5 * (1 + erf(x / 1.41421356237)); } function erfinv(x){ var z; var a = 0.147; var the_sign_of_x; if (0 == x) { the_sign_of_x = 0; } else if (x > 0) { the_sign_of_x = 1; } else { the_sign_of_x = -1; } if (0 != x) { var ln_1minus_x_sqrd = Math.log(1 - x * x); var ln_1minusxx_by_a = ln_1minus_x_sqrd / a; var ln_1minusxx_by_2 = ln_1minus_x_sqrd / 2; var ln_etc_by2_plus2 = ln_1minusxx_by_2 + (2/(Math.PI * a)); var first_sqrt = Math.sqrt((ln_etc_by2_plus2 * ln_etc_by2_plus2) - ln_1minusxx_by_a); var second_sqrt = Math.sqrt(first_sqrt - ln_etc_by2_plus2); z = second_sqrt * the_sign_of_x; } else { z = 0; } return z; } function PhiInv(y) { return 1.41421356237 * erfinv(2 * y - 1); } function basic_test() { var n = 100; var c = 0.55; var p_a = 0.5; var margin = {top: 30, right: 0, bottom: 20, left: 30}, width = 700 - margin.left - margin.right, height = 290 - margin.top - margin.bottom, fig_height = 200 - margin.top - margin.bottom, fig_width = 450; var svg = d3.select("div#basic_test") .append("svg") .attr("width", width + margin.left + margin.right) .attr("height", height + margin.top + margin.bottom) .append("g") .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); var x = d3.scaleLinear() .domain([0, 1]) .range([0, fig_width]); var xAxisTop = svg.append("g") .attr("transform", "translate(0," + fig_height + ")") .call(d3.axisBottom(x)); xAxisTop.selectAll(".tick text") .attr("font-family", "Arvo"); var xBtm = d3.scaleLinear() .domain([0, 1]) .range([0, fig_width]); var xAxisBtm = svg.append("g") .attr("transform", "translate(0," + 1.6 * fig_height + ")") .call(d3.axisBottom(xBtm)); xAxisBtm.selectAll(".tick text") .attr("font-family", "Arvo"); var y = d3.scaleLinear() .range([fig_height, 0]) .domain([0, 1]); var yAxisTop = svg.append("g") .call(d3.axisLeft(y).ticks(4)); yAxisTop.selectAll(".tick text") .attr("font-family", "Arvo"); var yBtm = d3.scaleLinear() .range([1.6 * fig_height, 1.3 * fig_height]) .domain([0, 1]); var yAxisBtm = svg.append("g") .call(d3.axisLeft(yBtm).ticks(1)); yAxisBtm.selectAll(".tick text") .attr("font-family", "Arvo"); var err1_data = [{'x': p_a, 'y': 0}]; for (var p = p_a; p > 0; p -= 0.001) { var pp = Math.sqrt(n / (p * (1 - p))) * (p - c); err1_data.push({'x': p, 'y': Phi(pp)}); } var err2_data = [{'x': p_a, 'y': 0}]; for (var p = p_a; p < 1; p += 0.001) { var pp = Math.sqrt(n / (p * (1 - p))) * (p - c); err2_data.push({'x': p, 'y': 1 - Phi(pp)}); } var err1_curve = svg .append('g') .append("path") .datum(err1_data) .attr("fill", "#65AD69") .attr("border", 0) .attr("opacity", ".8") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d['x']); }) .y(function(d) { return y(d['y']); }) ); var err2_curve = svg .append('g') .append("path") .datum(err2_data) .attr("fill", "#EDA137") .attr("border", 0) .attr("opacity", ".8") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d['x']); }) .y(function(d) { return y(d['y']); }) ); var phi_data_0 = [{'x': 0, 'y': 0}, {'x': c, 'y': 0}]; var phi_data_1 = [{'x': c, 'y': 1}, {'x': 1, 'y': 1}]; var phi_data_dash = [{'x': c, 'y': 0}, {'x': c, 'y': 1}]; var phi_curve_0 = svg .append('g') .append("path") .datum(phi_data_0) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 2.5) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); var phi_curve_1 = svg .append('g') .append("path") .datum(phi_data_1) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 2.5) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); var phi_curve_dash = svg .append('g') .append("path") .datum(phi_data_dash) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 1) .style("stroke-dasharray", ("3, 3")) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); var phi_dot = svg.append('g') .selectAll("dot") .data([{'x': xBtm(c), 'y': yBtm(1)}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#fff") .attr("stroke", "#348ABD") .attr("stroke-width", 2) .on("mouseover", function (d) {d3.select(this).style("cursor", "pointer");}) .on("mouseout", function (d) {}) .call(d3.drag() .on("drag", dragged_c) ); svg.append('g') .selectAll("dot") .data([{'x': x(p_a), 'y': y(0)}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#E86456") .attr("stroke", "#000") .attr("stroke-width", 1) .on("mouseover", function (d) {d3.select(this).style("cursor", "pointer");}) .on("mouseout", function (d) {}) .call(d3.drag() .on("drag", dragged_pa) ); function updatePhiLine() { var phi_data_0 = [{'x': 0, 'y': 0}, {'x': c, 'y': 0}]; var phi_data_1 = [{'x': c, 'y': 1}, {'x': 1, 'y': 1}]; var phi_data_dash = [{'x': c, 'y': 0}, {'x': c, 'y': 1}]; phi_curve_0 .datum(phi_data_0) .transition() .duration(0) .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); phi_curve_1 .datum(phi_data_1) .transition() .duration(0) .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); phi_curve_dash .datum(phi_data_dash) .transition() .duration(0) .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); } function updateErrCurves() { var err1_data = [{'x': p_a, 'y': 0}]; for (var p = p_a; p > 0; p -= 0.001) { var pp = Math.sqrt(n / (p * (1 - p))) * (p - c); err1_data.push({'x': p, 'y': Phi(pp)}); } err1_data.push({'x': 0, 'y': 0}); var err2_data = [{'x': p_a, 'y': 0}]; for (var p = p_a; p < 1; p += 0.001) { var pp = Math.sqrt(n / (p * (1 - p))) * (p - c); err2_data.push({'x': p, 'y': 1 - Phi(pp)}); } err2_data.push({'x': 1, 'y': 0}); err1_curve .datum(err1_data) .transition() .duration(0) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d['x']); }) .y(function(d) { return y(d['y']); }) ); err2_curve .datum(err2_data) .transition() .duration(0) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d['x']); }) .y(function(d) { return y(d['y']); }) ); } function dragged_pa(d) { d3.select(this).attr("cx", d.x = Math.min(x(0.9999), Math.max(d3.event.x, x(0.0001)))); p_a = x.invert(d.x); updateErrCurves(); } function dragged_c(d) { d3.select(this).attr("cx", d.x = Math.min(xBtm(0.9999), Math.max(d3.event.x, xBtm(0.0001)))); c = xBtm.invert(d.x); updatePhiLine(); updateErrCurves(); } var labels_x = 450; var labels_y = 0; var labels_v = 18; svg.append("path") .attr("stroke", "#65AD69") .attr("stroke-width", 4) .attr("opacity", ".8") .datum([{x: labels_x, y: labels_y}, {x: labels_x + 25, y: labels_y}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append("path") .attr("stroke", "#000") .attr("stroke-width", 1) .datum([{x: labels_x, y: labels_y - 2}, {x: labels_x + 25, y: labels_y - 2}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg .append("text") .attr("text-anchor", "start") .attr("y", labels_y + 5) .attr("x", labels_x + 30) .attr("font-family", "Arvo") .attr("font-weight", 700) .text("P( reject H | H is true)") .style("font-size", "14px") .style("fill", "#65AD69"); svg.append("path") .attr("stroke", "#EDA137") .attr("stroke-width", 4) .attr("opacity", ".8") .datum([{x: labels_x, y: labels_y + labels_v}, {x: labels_x + 25, y: labels_y + labels_v}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append("path") .attr("stroke", "#000") .attr("stroke-width", 1) .datum([{x: labels_x, y: labels_y + labels_v - 2}, {x: labels_x + 25, y: labels_y + labels_v - 2}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg .append("text") .attr("text-anchor", "start") .attr("y", labels_y + labels_v + 5) .attr("x", labels_x + 30) .attr("font-family", "Arvo") .attr("font-weight", 700) .text("P(accept H | K is true)") .style("font-size", "14px") .style("fill", "#EDA137"); svg.append('g') .selectAll("dot") .data([{'x': labels_x + 14, 'y': labels_y + 2 * labels_v - 3}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#E86456") .attr("stroke", "#000") .attr("stroke-width", 1); svg.append("path") .attr("stroke", "#348ABD") .attr("stroke-width", 3) .attr("opacity", "1") .datum([{x: labels_x + 5, y: labels_y + 3 * labels_v - 5}, {x: labels_x + 25, y: labels_y + 3 * labels_v - 5}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append('g') .selectAll("dot") .data([{'x': labels_x + 7, 'y': labels_y + 3 * labels_v - 5}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#fff") .attr("stroke", "#348ABD") .attr("stroke-width", 2); d3.select("#basic_test") .append("div") .text("\\(p_b\\)") .style('color', '#000') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", labels_x + 15 + margin.left + "px") .style("top", fig_height + 20 + "px"); d3.select("#basic_test") .append("div") .text("\\(p_a\\)") .style('color', '#E86456') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", fig_width + margin.left + 30 + "px") .style("top", labels_y + 2 * labels_v + 12 + "px"); d3.select("#basic_test") .append("div") .text("\\(\\varphi(x) \\)") .style('color', '#348ABD') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", fig_width + margin.left + 30 + "px") .style("top", labels_y + 3 * labels_v + 12 + "px"); d3.select("#basic_test") .append("div") .text("\\(x\\)") .style('color', '#000') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .attr("font-weight", 700) .style("position", "absolute") .style("left", labels_x + 15 + margin.left + "px") .style("top", 1.6 * fig_height + 20 + "px"); } basic_test(); </script><p><img data-proofer-ignore data-src="." alt="" /> <em>Fig. 1. Visualization of basic test experiment. Parameters $p_a$ and $c$ are draggable.</em></p><h3 id="power-of-a-test">Power of a test</h3><p>Ideally we want to minimize both errors simulaneously and pick the optimal test. The problem is that criterias $\varphi_0(x) \equiv 0$ and $\varphi_1(x) \equiv 1$ are optimal if one needs to minimize one of the errors, but they don’t minimize both errors at the same time. In practice, the upper bound $\alpha$ is taken for the probability of error of the 1st kind and probability of error of the 2nd kind is minimized. Typically, $0.01 \leq \alpha \leq 0.1$ (the set belonging to the more severe consequences is the alternative).</p><p>Now suppose $\varphi$ is a test for $H \colon \vartheta \in \Theta_H$ vs $K \colon \vartheta \in \Theta_K$. Let’s define function</p>\[\beta_\varphi(\vartheta) = 1 - \mathbb{E}_\vartheta[\varphi(X)].\]<p>Note that for non-randomized test $\varphi$ we have</p>\[\beta_\varphi(\vartheta) = P_\vartheta(\varphi(X) = 0),\]<p>which is the probability to decide for $H$. In particular,</p><ul><li>$\vartheta \in \Theta_H$: $1 - \beta_\varphi(\vartheta)$ is the probability of an error of the 1st kind,<li>$\vartheta \in \Theta_K$: $\beta_\varphi(\vartheta)$ is the probability of an error of the 2nd kind.</ul><p>The function $1 - \beta_\varphi(\vartheta)$ for $\vartheta \in \Theta_K$, which is the probability of correctly rejecting hypothesis $H$, when alterntative $K$ is true, is called <strong>power of a test</strong> $\varphi$. The same intuition holds for randomized tests. Test $\varphi$ is called a test with <strong>significance level</strong> $\alpha \in [0, 1]$ if</p>\[1 - \beta_\varphi(\vartheta) \leq \alpha \quad \forall \vartheta \in \Theta_H.\]<p>A test with significance level $\alpha$ has a probability of an error of the 1st kind, which is bounded by $\alpha$. We will denote set of all tests with significance level $\alpha$ as $\Phi_\alpha$. Test $\varphi$ is also called <strong>unbiased with significance level</strong> $\alpha$ if $\varphi \in \Phi_\alpha$ and</p>\[1-\beta_\varphi(\vartheta) \geq \alpha \quad \forall \vartheta \in \Theta_K.\]<p>For an unbiased test with significance level $\alpha$ the probability of deciding for $K$ for every $\vartheta \in \Theta_K$ is not smaller than for $\vartheta \in \Theta_H$. The set of all unbiased tests with level $\alpha$ we will call $\Phi_{\alpha \alpha}$.</p><p>Test $\tilde{\varphi} \in \Phi_\alpha$ is called <strong>uniformly most powerful (UMP)</strong> test with significance level $\alpha$ if</p>\[\beta_{\tilde{\varphi}}(\vartheta) = \inf_{\varphi \in \Phi_\alpha} \beta_\varphi(\vartheta) \quad \forall \vartheta \in \Theta_K.\]<p>Test $\tilde{\varphi} \in \Phi_{\alpha\alpha}$ is called <strong>uniformly most powerful unbiased (UMPU)</strong> test with significance level $\alpha$ if</p>\[\beta_{\tilde{\varphi}}(\vartheta) = \inf_{\varphi \in \Phi_{\alpha\alpha}} \beta_\varphi(\vartheta) \quad \forall \vartheta \in \Theta_K.\]<h3 id="neyman-pearson-lemma">Neyman-Pearson lemma</h3><p>Let’s start with <em>simple hypothesis</em>:</p>\[H\colon \vartheta \in \lbrace \vartheta_0 \rbrace \ \ \text{vs} \ \ K\colon \vartheta \in \lbrace \vartheta_1 \rbrace , \quad \vartheta_0 \neq \vartheta_1.\]<p>Corresponding densities: $p_i = \frac{dP_{\vartheta_i}}{dx}$. UMP-test with level $\alpha$ maximizes</p>\[1-\beta_\varphi(\vartheta_1) = \mathbb{E}_{\vartheta_1}[\varphi(X)] = \int_{\mathcal{X}} \varphi(x)p_1(x)dx\]<p>under the constraint</p>\[1-\beta_\varphi(\vartheta_0) = \mathbb{E}_{\vartheta_0}[\varphi(X)] = \int_{\mathcal{X}} \varphi(x)p_0(x)dx \leq \alpha.\]<p>In the situation of simple hypotheses a test $\varphi$ is called <strong>a Neyman-Pearson test (NP test)</strong> if $c\in[0, \infty)$ exists such that</p>\[\varphi(x): \left \lbrace \begin{array}{cl} 1, &amp; p_1(x) &gt; cp_0(x), \\ 0, &amp; p_1(x) &lt; cp_0(x). \end{array} \right.\]<p>Let $\tilde{\varphi}$ be an NP-test with constant $\tilde{c}$ and let $\varphi$ be some other test with</p>\[\beta_\varphi(\vartheta_0) \geq \beta_{\tilde{\varphi}}(\vartheta_0).\]<p>Then we have</p>\[\begin{aligned} \beta_\varphi(\vartheta_1) - \beta_{\tilde{\varphi}}(\vartheta_1) &amp;= (1 - \beta_{\tilde{\varphi}}(\vartheta_1) ) - (1 - \beta_\varphi(\vartheta_1) ) \\&amp;=\int (\tilde{\varphi} - \varphi) p_1 dx \\&amp;= \int (\tilde{\varphi} - \varphi)(p_1 - \tilde{c}p_0)dx + \int \tilde{c} p_0 (\tilde{\varphi} - \varphi) dx. \end{aligned}\]<p>For the first integral note that</p>\[\begin{aligned}\tilde{\varphi} - \varphi &gt; 0 \Longrightarrow \tilde{\varphi} &gt; 0 \Longrightarrow p_1 \geq \tilde{c}p_0, \\ \tilde{\varphi} - \varphi &lt; 0 \Longrightarrow \tilde{\varphi} &lt; 1 \Longrightarrow p_1 \leq \tilde{c}p_0. \end{aligned}\]<p>Hence, $(\tilde{\varphi} - \varphi)(p_1 - \tilde{c}p_0) \geq 0$ always. The second integral is</p>\[\tilde{c}(\beta_{\tilde{\varphi}}(\vartheta_0) - \beta_\varphi(\vartheta_0)) \geq 0.\]<p>Therefore we have</p>\[\beta_\varphi(\vartheta_1) \geq \beta_{\tilde{\varphi}}(\vartheta_1)\]<p>and NP-test $\tilde{\varphi}$ is an UMP test with level $\alpha = \mathbb{E}_{\vartheta_0}[\tilde{\varphi}(X)]$. This statement is called <strong>NP lemma</strong>.</p><p>There are also other parts of this lemma which I will state here without proof:</p><ul><li>For any $\alpha \in [0, 1]$ there is an NP-test $\varphi$ with $\mathbb{E}_{\vartheta_0}[\varphi(X)] = \alpha$.<li>If $\varphi’$ is UMP with level $\alpha$, then $\varphi’$ is (a.s.) an NP-test. Also</ul>\[\mathbb{E}_{\vartheta_0}[\varphi'(X)] &lt; \alpha \Longrightarrow \mathbb{E}_{\vartheta_1}[\varphi'(X)]=1.\]<p>An NP-test $\tilde{\varphi}$ for $H \colon \vartheta = \vartheta_0$ vs $K \colon \vartheta = \vartheta_1$ is uniquely defined outside of</p>\[S_= =\lbrace x\ |\ p_1(x) = \tilde{c}p_0(x) \rbrace.\]<p>On $S_=$ set the test can be chosen such that $\beta_{\tilde{\varphi}}(\vartheta_0) = \alpha$.</p><p>Is must also be noted that every NP-test $\tilde{\varphi}$ with $\beta_{\tilde{\varphi}}(\vartheta_0) \in (0, 1)$ is unbiased. In particular</p>\[\alpha := 1 - \beta_{\tilde{\varphi}}(\vartheta_0) &lt; 1 - \beta_{\tilde{\varphi}}(\vartheta_1).\] <details> <summary>Proof</summary> Take test $\varphi \equiv \alpha$. It has significance level $\alpha$ and since $\tilde{\varphi}$ is UMP, we have $$1-\beta_\varphi(\vartheta_1) \leq 1-\beta_{\tilde{\varphi}}(\vartheta_1).$$ If $\alpha = 1-\beta_{\tilde{\varphi}}(\vartheta_1) &lt; 1$, then $\varphi \equiv \alpha$ is UMP. Since every UMP test is an NP test, we know that $p_1(x) = \tilde{c}p_0(x)$ for almost all $x$. Therefore, $\tilde{c}=1$ and $p_1 = p_0$ a.s. and also $P_{\vartheta_0} = P_{\vartheta_1}$, which is contradictory. </details><h3 id="confidence-interval">Confidence interval</h3><p>Let $X_1, \dots X_n$ i.i.d. $\sim \mathcal{N}(\mu,\sigma^2)$ with $\sigma^2$ known. We test</p>\[H \colon \mu = \mu_0 \quad \text{vs} \quad K \colon \mu = \mu_1\]<p>with $\mu_0 &lt; \mu_1$. For the density of $X_1, \dots X_n$ it holds</p>\[p_j(x) = (2 \pi \sigma^2)^{-n/2} \exp \Big( -\frac{1}{2\sigma^2} \Big( \sum_{i=1}^{n} X_i^2 - 2 \mu_j \sum_{i=1}^{n}X_i + n\mu_j^2 \Big)\Big), \quad j = 0, 1.\]<p>As the inequality for the likelihood ratio which we need for the construction of the NP test, we get</p>\[\frac{p_1(x)}{p_0(x)} = \exp \Big( \frac{1}{\sigma^2} \sum_{i=1}^{n} x_i(\mu_1 - \mu_0) \Big) \cdot f(\sigma^2, \mu_1, \mu_0) &gt; \tilde{c},\]<p>where the known constant $f(\sigma^2, \mu_1, \mu_0)$ is positive. This inequality is equivalent to</p>\[\overline{X}_n = \frac{1}{n} \sum_{i=1}^{n}X_i &gt; c,\]<p>for some appropriate $c$ (because of $\mu_1 &gt; \mu_0$). Therefore it is equally well possible to determine $c$ such that</p>\[P_{\mu_0}(\overline{X}_n &gt; c) = \alpha\]<p>or equivalently</p>\[\begin{aligned} P_{\mu_0}\Big( &amp;\underbrace{\frac{\sqrt{n}(\overline{X}_n - \mu_0)}{\sigma}} &gt; \frac{\sqrt{n}(c-\mu_0)}{\sigma}\Big) = 1 - \Phi\Big(\frac{\sqrt{n}(c - \mu_0)}{\sigma}\Big) = \alpha. \\ &amp;\quad \color{Salmon}{\sim \mathcal{N}(0, 1)} \end{aligned}\]<p>If we call $u_p$ the <strong>p-quantile</strong> of $\mathcal{N}(0, 1)$, which is the value such that $\Phi(u_p)=p$, then we get</p>\[\frac{\sqrt{n}(c - \mu_0)}{\sigma} = u_{1-\alpha} \quad \Longleftrightarrow \quad c = \mu_0 + u_{1-\alpha}\frac{\sigma}{\sqrt{n}}.\]<p>The NP-test becomes</p>\[\tilde{\varphi}(X) = 1_{\lbrace\overline{X}_n &gt; \mu_0 + u_{1-\alpha} \frac{\sigma}{\sqrt{n}} \rbrace }.\]<p><button id="sample-button-h">Sample H</button> <button id="sample-button-k">Sample K</button> <label id="n-text">n:</label><input type="number" min="1" max="100" step="1" value="10" id="n-num" /> <button id="reset-button">Reset</button></p><div id="simple_hypothesis"></div><script> d3.select("#simple_hypothesis") .style("position", "relative"); function randn_bm() { var u = 0, v = 0; while(u === 0) u = Math.random(); while(v === 0) v = Math.random(); return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v ); } function gauss_data(mu, sigma, min, max) { var data = [{x: min, y: 0}]; for (var i = min; i < max; i += 0.01) { data.push({x: i, y: Math.exp(-0.5 * ((i - mu) / sigma) ** 2) / (sigma * Math.sqrt(2 * Math.PI)) }); } data.push({x: max, y: 0}); return data; } function quantile_data(u_q) { var data0 = [{x: 0, y: 0}]; for (var i = 0; i < u_q; i += 0.01) { data0.push({x: i, y: 1 - Phi(i) }); } var q = 1 - Phi(u_q); data0.push({x: u_q, y: q}); data0.push({x: u_q, y: 0}); var data1 = [{x: u_q, y: 0}]; for (var i = u_q; i < 3.5; i += 0.01) { data1.push({x: i, y: 1 - Phi(i) }); } data1.push({x: 3.5, y: 0}); return [data0, data1]; } function createSlider(svg_, parameter_update, x, loc_x, loc_y, letter, color, init_val, round_fun) { var slider = svg_.append("g") .attr("class", "slider") .attr("transform", "translate(" + loc_x + "," + loc_y + ")"); var drag = d3.drag() .on("start.interrupt", function() { slider.interrupt(); }) .on("start drag", function() { handle.attr("cx", x(round_fun(x.invert(d3.event.x)))); parameter_update(x.invert(d3.event.x)); }); slider.append("line") .attr("class", "track") .attr("x1", x.range()[0]) .attr("x2", x.range()[1]) .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); }) .attr("class", "track-inset") .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); }) .attr("class", "track-overlay") .call(drag); slider.insert("g", ".track-overlay") .attr("class", "ticks") .attr("transform", "translate(0," + 18 + ")") .selectAll("text") .data(x.ticks(6)) .enter().append("text") .attr("x", x) .attr("text-anchor", "middle") .attr("font-family", "Arvo") .text(function(d) { return d; }); var handle = slider.insert("circle", ".track-overlay") .attr("class", "handle") .attr("r", 6).attr("cx", x(init_val)); svg_ .append("text") .attr("text-anchor", "middle") .attr("y", loc_y + 3) .attr("x", loc_x - 21) .attr("font-family", "Arvo") .attr("font-size", 17) .text(letter) .style("fill", color); return handle; } function simple_hypothesis() { var mu0 = -1, mu1 = 1, sigma = 1, alpha = 0.05, n = 10; var u_q = PhiInv(1 - alpha); var power = 1 - Phi(Math.sqrt(n) * (mu0 - mu1) / sigma + u_q); var margin = {top: 30, right: 0, bottom: 20, left: 30}, width = 750 - margin.left - margin.right, height = 465 - margin.top - margin.bottom, fig_height = 200 - margin.top - margin.bottom, fig_width = 350; var svg = d3.select("div#simple_hypothesis") .append("svg") .attr("width", width + margin.left + margin.right) .attr("height", height + margin.top + margin.bottom) .append("g") .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); var x = d3.scaleLinear() .domain([-4, 4]) .range([0, fig_width]); var xAxisTop = svg.append("g") .attr("transform", "translate(0," + fig_height + ")") .call(d3.axisBottom(x)); xAxisTop.selectAll(".tick text") .attr("font-family", "Arvo"); var xBtm = d3.scaleLinear() .domain([-4, 4]) .range([0, fig_width]); var xAxisBtm = svg.append("g") .attr("transform", "translate(0," + 1.6 * fig_height + ")") .call(d3.axisBottom(xBtm)); xAxisBtm.selectAll(".tick text") .attr("font-family", "Arvo"); var xRight = d3.scaleLinear() .domain([0, 3.5]) .range([1.2 * fig_width, 1.9 * fig_width]); var xAxisRight = svg.append("g") .attr("transform", "translate(0," + 2 * fig_height + ")") .call(d3.axisBottom(xRight).ticks(5)); xAxisRight.selectAll(".tick text") .attr("font-family", "Arvo"); var y = d3.scaleLinear() .range([fig_height, 0]) .domain([0, 1]); var yAxisTop = svg.append("g") .call(d3.axisLeft(y).ticks(4)); yAxisTop.selectAll(".tick text") .attr("font-family", "Arvo"); var yBtm = d3.scaleLinear() .range([1.6 * fig_height, 1.3 * fig_height]) .domain([0, 1]); var yAxisBtm = svg.append("g") .call(d3.axisLeft(yBtm).ticks(1)); yAxisBtm.selectAll(".tick text") .attr("font-family", "Arvo"); var yRight = d3.scaleLinear() .range([2 * fig_height, 0]) .domain([0, 0.5]); var yAxisRight = svg.append("g") .attr("transform", "translate(" + 1.2 * fig_width + ",0)") .call(d3.axisLeft(yRight).ticks(4)); yAxisRight.selectAll(".tick text") .attr("font-family", "Arvo"); var mu0_data = gauss_data(mu0, sigma, -4, 4); var mu0_curve = svg .append('g') .append("path") .datum(mu0_data) .attr("fill", "#65AD69") .attr("border", 0) .attr("opacity", ".8") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d.x); }) .y(function(d) { return y(d.y); }) ); var mu1_data = gauss_data(mu1, sigma, -4, 4); var mu1_curve = svg .append('g') .append("path") .datum(mu1_data) .attr("fill", "#EDA137") .attr("border", 0) .attr("opacity", ".8") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d.x); }) .y(function(d) { return y(d.y); }) ); var q_data = quantile_data(u_q); var quantile_curve0 = svg .append('g') .append("path") .datum(q_data[0]) .attr("fill", "#348ABD") .attr("border", 0) .attr("opacity", ".8") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d.x); }) .y(function(d) { return yRight(d.y); }) ); var quantile_curve1 = svg .append('g') .append("path") .datum(q_data[1]) .attr("fill", "#348ABD") .attr("border", 0) .attr("opacity", ".2") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d.x); }) .y(function(d) { return yRight(d.y); }) ); function updateQuantileCurve() { q_data = quantile_data(u_q); quantile_curve0 .datum(q_data[0]) .transition() .duration(0) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d.x); }) .y(function(d) { return yRight(d.y); }) ); quantile_curve1 .datum(q_data[1]) .transition() .duration(0) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d.x); }) .y(function(d) { return yRight(d.y); }) ); } function updatePower() { var rc = 1000; if (power > 0.999) { rc = 10000; } power = 1 - Phi(Math.sqrt(n) * (mu0 - mu1) / sigma + u_q); power_text .transition() .duration(500) .text('Power: ' + Math.round(rc * power) / rc); } function dragged_u(d) { var u_x = Math.min(xRight(3.5), Math.max(d3.event.x, xRight(0))); u_q = xRight.invert(u_x); alpha = 1 - Phi(u_q); var u_y = yRight(alpha); d3.select(this).attr("cx", d.x = u_x).attr("cy", d.y = u_y); updatePhiLine(); var rc = 1000; if (alpha < 0.001) { rc = 10000; } alpha_text .transition() .duration(500) .text('Significance level: ' + Math.round(rc * alpha) / rc); updatePower(); updateQuantileCurve(); } var u_dot = svg.append('g') .selectAll("dot") .data([{'x': xRight(u_q), 'y': yRight(alpha)}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#fff") .attr("stroke", "#348ABD") .attr("stroke-width", 2) .on("mouseover", function(d) { d3.select(this) .style("cursor", "pointer");}) .on("mousemove", function (d) {}) .call(d3.drag() .on("drag", dragged_u) ); function updatePhiLine() { reset(); c = mu0 + u_q * sigma / Math.sqrt(n); var phi_data_0 = [{'x': -4, 'y': 0}, {'x': c, 'y': 0}]; var phi_data_1 = [{'x': c, 'y': 1}, {'x': 4, 'y': 1}]; var phi_data_dash = [{'x': c, 'y': 0}, {'x': c, 'y': 1}]; phi_dot .transition() .duration(0) .attr("cx", xBtm(c) ); phi_curve_0 .datum(phi_data_0) .transition() .duration(0) .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); phi_curve_1 .datum(phi_data_1) .transition() .duration(0) .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); phi_curve_dash .datum(phi_data_dash) .transition() .duration(0) .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); } var c = mu0 + u_q * sigma / Math.sqrt(n); var phi_data_0 = [{'x': -4, 'y': 0}, {'x': c, 'y': 0}]; var phi_data_1 = [{'x': c, 'y': 1}, {'x': 4, 'y': 1}]; var phi_data_dash = [{'x': c, 'y': 0}, {'x': c, 'y': 1}]; var phi_curve_0 = svg .append('g') .append("path") .datum(phi_data_0) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 2.5) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); var phi_curve_1 = svg .append('g') .append("path") .datum(phi_data_1) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 2.5) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); var phi_curve_dash = svg .append('g') .append("path") .datum(phi_data_dash) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 1) .style("stroke-dasharray", ("3, 3")) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xBtm(d['x']); }) .y(function(d) { return yBtm(d['y']); }) ); var phi_dot = svg.append('g') .selectAll("dot") .data([{'x': xBtm(c), 'y': yBtm(1)}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#fff") .attr("stroke", "#348ABD") .attr("stroke-width", 2); function updateCurves(delay) { mu0_data = gauss_data(mu0, sigma, -4, 4); mu1_data = gauss_data(mu1, sigma, -4, 4); mu0_curve .datum(mu0_data) .transition() .delay(delay) .duration(0) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d.x); }) .y(function(d) { return y(d.y); }) ); mu1_curve .datum(mu1_data) .transition() .delay(delay) .duration(0) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d.x); }) .y(function(d) { return y(d.y); }) ); } function updateSigma(x) { reset(); sigma = Math.sqrt(x); updatePower(); updateCurves(0); updatePhiLine(); } function trivialRound(x) { return x; } var sigma_x = d3.scaleLinear() .domain([0.15, 2]) .range([0, width * 0.4]) .clamp(true); createSlider(svg, updateSigma, sigma_x, margin.left, 2 * fig_height, "", "#A9A750", sigma, trivialRound); d3.select("#simple_hypothesis") .append("div") .text("\\(\\sigma^2 \\)") .style('color', '#A9A750') .style("font-size", "17px") .style("font-weight", "700") .attr("font-family", "Arvo") .attr("font-weight", 700) .attr("font-size", 20) .style("position", "absolute") .style("left", margin.left + "px") .style("top", 2 * fig_height + 15 + "px"); d3.select("#n-num").on("input", function() { n = this.value; updatePhiLine(); updatePower(); }); var table_nums = [0, 0, 0, 0]; function updateTableText() { table_text_hh .transition() .duration(500) .text(table_nums[0]); table_text_hk .transition() .duration(500) .text(table_nums[1]); table_text_kh .transition() .duration(500) .text(table_nums[2]); table_text_kk .transition() .duration(500) .text(table_nums[3]); } var avg_dots = []; function sampleGauss(mu, color) { var avg_dur = 1200; var smpl_dots = []; var avg = 0; for (var i = 0; i < n; i += 1) { var random_sample = mu + sigma * randn_bm(); smpl_dots.push(svg.append('g') .selectAll("dot") .data([{x: random_sample, y: 1}]) .enter() .append("circle") .attr("cx", function (d) { return x(d.x); } ) .attr("cy", function (d) { return y(d.y); } ) .attr("r", 3) .style("fill", color) .attr("stroke", "#000") .attr("stroke-width", 1)); smpl_dots[i].transition() .duration(avg_dur) .attr("cx", function (d) { return x(random_sample); } ) .attr("cy", function (d) { return y(0); } ); avg += random_sample; } avg /= n; for (var i = 0; i < n; i += 1) { smpl_dots[i] .transition() .delay(avg_dur) .duration(avg_dur) .attr("cx", function (d) { return x(avg); } ) .attr("cy", function (d) { return y(0); } ); if (i > 0) { smpl_dots[i].transition().delay(2 * avg_dur).remove(); } else { avg_dots.push(smpl_dots[0]); } } if (avg > c) { smpl_dots[0] .transition() .delay(2 * avg_dur) .duration(avg_dur) .attr("cy", function (d) { return yBtm(1); } ); if (mu == mu0) { table_nums[2] += 1; } else { table_nums[3] += 1; } } else { smpl_dots[0] .transition() .delay(2 * avg_dur) .duration(avg_dur) .attr("cy", function (d) { return yBtm(0); } ); if (mu == mu0) { table_nums[0] += 1; } else { table_nums[1] += 1; } } updateTableText(); } d3.select("#sample-button-h").on("click", function() {sampleGauss(mu0, "#65AD69")}); d3.select("#sample-button-k").on("click", function() {sampleGauss(mu1, "#EDA137")}); function reset() { for (var i = 0; i < avg_dots.length; i += 1) { avg_dots[i].remove(); } avg_dots = []; table_nums = [0, 0, 0, 0]; updateTableText(); } d3.select("#reset-button").on("click", function() { reset(); }); var alpha_text = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.6 * fig_height) .attr("x", 1.2 * fig_width + 5) .attr("font-family", "Arvo") .text("Significance level: " + alpha) .style("font-size", "14px") .style("fill", "#348ABD"); var power_text = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.9 * fig_height) .attr("x", 1.2 * fig_width + 5) .attr("font-family", "Arvo") .text("Power: " + power) .style("font-size", "14px") .style("fill", "#348ABD"); d3.select("#simple_hypothesis") .append("div") .text("\\(\\alpha \\)") .style('color', '#000') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.2 * fig_width + 5 + margin.left + "px") .style("top", 15 + "px"); d3.select("#simple_hypothesis") .append("div") .text("\\(u_{1-\\alpha} \\)") .style('color', '#000') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.9 * fig_width + 5 + margin.left + "px") .style("top", 2 * fig_height + 15 + "px"); var labels_x = 250; var labels_y = 0; svg.append("path") .attr("stroke", "#65AD69") .attr("stroke-width", 4) .attr("opacity", ".8") .datum([{x: labels_x, y: labels_y}, {x: labels_x + 25, y: labels_y}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append("path") .attr("stroke", "#000") .attr("stroke-width", 1) .datum([{x: labels_x, y: labels_y - 2}, {x: labels_x + 25, y: labels_y - 2}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg .append("text") .attr("text-anchor", "start") .attr("y", labels_y + 5) .attr("x", labels_x + 30) .attr("font-family", "Arvo") .attr("font-weight", 700) .text("H distribution") .style("font-size", "14px") .style("fill", "#65AD69"); svg.append("path") .attr("stroke", "#EDA137") .attr("stroke-width", 4) .attr("opacity", ".8") .datum([{x: labels_x, y: labels_y + 15}, {x: labels_x + 25, y: labels_y + 15}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append("path") .attr("stroke", "#000") .attr("stroke-width", 1) .datum([{x: labels_x, y: labels_y + 13}, {x: labels_x + 25, y: labels_y + 13}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg .append("text") .attr("text-anchor", "start") .attr("y", labels_y + 20) .attr("x", labels_x + 30) .attr("font-family", "Arvo") .attr("font-weight", 700) .text("K distribution") .style("font-size", "14px") .style("fill", "#EDA137"); svg.append("path") .attr("stroke", "#348ABD") .attr("stroke-width", 3) .attr("opacity", "1") .datum([{x: labels_x + 5, y: labels_y + 30}, {x: labels_x + 25, y: labels_y + 30}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append('g') .selectAll("dot") .data([{'x': labels_x + 7, 'y': labels_y + 30}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#fff") .attr("stroke", "#348ABD") .attr("stroke-width", 2); d3.select("#simple_hypothesis") .append("div") .text("\\(\\varphi(x) \\)") .style('color', '#348ABD') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", labels_x + margin.left + 30 + "px") .style("top", labels_y + 45 + "px"); svg.append("path") .attr("stroke", "#348ABD") .attr("stroke-width", 4) .attr("opacity", ".8") .datum([{x: labels_x + fig_width, y: labels_y}, {x: labels_x + fig_width + 25, y: labels_y}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append("path") .attr("stroke", "#000") .attr("stroke-width", 1) .datum([{x: labels_x + fig_width, y: labels_y - 2}, {x: labels_x + fig_width + 25, y: labels_y - 2}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); d3.select("#simple_hypothesis") .append("div") .text("\\(1-\\Phi(x) \\)") .style('color', '#348ABD') .style("font-size", "15px") .style("font-weight", "700") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", labels_x + fig_width + margin.left + 30 + "px") .style("top", labels_y + 15 + "px"); var table_text_acc_h = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.35 * fig_height) .attr("x", 0.5 * fig_width) .attr("font-family", "Arvo") .text("Accepted H") .style("font-size", "14px") .style("fill", "#65AD69"); var table_text_rej_h = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.35 * fig_height) .attr("x", 0.85 * fig_width) .attr("font-family", "Arvo") .text("Rejected H") .style("font-size", "14px") .style("fill", "#EDA137"); var table_text_true_h = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.6 * fig_height) .attr("x", 0.2 * fig_width) .attr("font-family", "Arvo") .text("H is true") .style("font-size", "14px") .style("fill", "#65AD69"); var table_text_true_k = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.9 * fig_height) .attr("x", 0.2 * fig_width) .attr("font-family", "Arvo") .text("K is true") .style("font-size", "14px") .style("fill", "#EDA137"); var table_text_hh = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.6 * fig_height) .attr("x", 0.6 * fig_width) .attr("font-family", "Arvo") .text("0") .style("font-size", "14px") .style("fill", "#65AD69"); var table_text_hk = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.9 * fig_height) .attr("x", 0.6 * fig_width) .attr("font-family", "Arvo") .text("0") .style("font-size", "14px") .style("fill", "#E86456"); var table_text_kh = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.6 * fig_height) .attr("x", 0.95 * fig_width) .attr("font-family", "Arvo") .text("0") .style("font-size", "14px") .style("fill", "#E86456"); var table_text_kk = svg .append("text") .attr("text-anchor", "start") .attr("y", 2.9 * fig_height) .attr("x", 0.95 * fig_width) .attr("font-family", "Arvo") .text("0") .style("font-size", "14px") .style("fill", "#EDA137"); } simple_hypothesis(); </script><p><img data-proofer-ignore data-src="." alt="" /> <em>Fig. 2. Visualization of simple hypothesis testing with $\mu_0 = -1$ and $\mu_1=1$. Significance level $\alpha$ on the right-hand side is draggable.</em></p><p>Simple hypotheses like that are not relevant in practice, <ins>but</ins>:</p><ul><li>They explain intuitively how to construct a test. One needs a so called <strong>confidence interval</strong> $c(X) \subset \Theta$ in which the unknown parameter lies with probability $1-\alpha$. In example above we used that for</ul>\[c(X) = [\overline{X}_n - u_{1-\alpha} \frac{\sigma}{\sqrt{n}}, \infty)\]<p>we have</p>\[P_{\mu_0}(\mu_0 \in c(X)) = P_{\mu_0}(\overline{X}_n \leq \mu_0 + \frac{\sigma}{\sqrt{n}} u_{1-\alpha}) = 1-\alpha.\]<p>Any such $c(X)$ can be used to construct a test, for example,</p>\[c'(X) =\Big[\overline{X}_n -u_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}, \overline{X}_n + u_{1-\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} \Big].\]<p>In addition, simple hypotheses tell you on which side the alternative lies.</p><ul><li>Formal results like the NP lemma are useful to derive more relevant results.</ul><h3 id="monotone-likelihood-ratio">Monotone likelihood ratio</h3><p>Let $\Theta = \mathbb{R}$, $\mathcal{P} = \lbrace P_\vartheta \mid \vartheta \in \Theta \rbrace$ and $T\colon \mathcal{X} \rightarrow \mathbb{R}$ be some statistic. Family $\mathcal{P}$ is called <strong>class with monotone (isotonic) likelihood ratio</strong> if for every $\vartheta &lt; \vartheta_1$ there exists monotonically increasing function $H_{\vartheta_0, \vartheta_1} \colon \mathbb{R} \rightarrow [0, \infty)$, such that</p>\[\frac{p_{\vartheta_1}(x)}{p_{\vartheta_0}(x)} =H_{\vartheta_0, \vartheta_1}(T(x)) \quad P_{\vartheta_0} + P_{\vartheta_1}\text{-a.s.}\]<p>In our example above we had</p>\[\frac{p_{\mu_1}(x)}{p_{\mu_0}(x)} = \exp \Big( \frac{1}{\sigma^2} \sum_{i=1}^{n} x_i(\mu_1 - \mu_0) \Big) \cdot f(\sigma^2, \mu_1, \mu_0),\]<p>which is monotonically increasing in $\overline{x}_n$. This can be generalized to one-parametric <a href="https://astralord.github.io/posts/visual-guide-to-statistics-part-i-basics-of-point-estimation/#exponential-family">exponential families</a>.</p><p>Let $\mathcal{P} = \lbrace P_\vartheta \mid \vartheta \in \Theta \rbrace$ be class with monotone likelihood ratio in $T$, $\vartheta \in \Theta$, $\alpha \in (0, 1)$ and we test the one-sided hypothesis</p>\[H\colon\vartheta \leq \vartheta_0 \quad \text{vs} \quad K\colon\vartheta &gt; \vartheta_0.\]<p>Let also</p>\[\tilde{\varphi}(x) = 1_{\lbrace T(x) &gt; c\rbrace} + \gamma 1_{\lbrace T(x) = c\rbrace},\]<p>where $c = \inf \lbrace t \mid P_{\vartheta_0}(T(X) &gt; t) \leq \alpha \rbrace$ and</p>\[\gamma = \left \lbrace \begin{array}{cl} \frac{\alpha - P_{\vartheta_0}(T(X) &gt; c) }{ P_{\vartheta_0}(T(X) = c) }, &amp; \text{if } P_{\vartheta_0}(T(X) = c) \neq 0 \\ 0, &amp; \text{otherwise}. \end{array} \right.\]<p>Then $1-\beta_{\tilde{\varphi}}(\vartheta_0) = \alpha$ and $\tilde{\varphi}$ is UMP test with significance level $\alpha$.</p><details> <summary>Proof</summary> We have $$1-\beta_{\tilde{\varphi}}(\vartheta_0)=P_{\vartheta_0}(T(X)&gt;c) + \gamma P_{\vartheta_0}(T(X) = c) = \alpha. $$ Let $\vartheta_0 &lt; \vartheta_1$, then due to monotonicity $$H_{\vartheta_0, \vartheta_1}(T(x)) &gt; H_{\vartheta_0, \vartheta_1}(c) = s \quad \Longrightarrow \quad T(x) &gt; c $$ and $$\tilde{\varphi}(x) = \left \{ \begin{array}{cl} 1, &amp; H_{\vartheta_0, \vartheta_1}(x) &gt; s, \\ 0, &amp; H_{\vartheta_0, \vartheta_1}(x) &lt; s. \end{array} \right.$$ Therefore $\tilde{\varphi}$ is NP-test with significance level $\alpha$ and by NP lemma $$ \beta_{\tilde{\varphi}}(\vartheta_1) = \inf \lbrace \beta_\varphi(\vartheta_1)\ |\ \beta_\varphi(\vartheta_0) = 1-\alpha \rbrace. $$ As $\tilde{\varphi}$ doesn't depend on $\vartheta_1$, this relation holds for all $\vartheta_1 &gt; \vartheta_0$. Finally, let $\varphi'(x) = 1 - \tilde{\varphi}(x)$. Using the similar reasoning as above one can show that $$\beta_{\varphi'}(\vartheta_2) = \inf \lbrace \beta_\varphi(\vartheta_2)\ |\ \beta_\varphi(\vartheta_0) = 1 - \alpha \rbrace \quad \forall \vartheta_2 &lt; \vartheta_0. $$ For trivial test $\overline{\varphi} \equiv \alpha$ the following equality takes place: $\beta_{\overline{\varphi}}(\vartheta_0) = 1-\alpha$. Hence we conclude that $$1-\beta_{\tilde{\varphi}}(\vartheta_2) = \beta_{\varphi'}(\vartheta_2) \geq \beta_{1-\overline{\varphi}}(\vartheta_2) = 1-\beta_{\overline{\varphi}}(\vartheta_2) = \alpha. $$ Hence, $1-\beta_{\tilde{\varphi}}(\vartheta_2) \geq \alpha$, $\tilde{\varphi} \in \Phi_\alpha$ and $\tilde{\varphi}$ is UMP test. Also for any $\vartheta &lt; \vartheta_0$ we have $$\beta_{\tilde{\varphi}}(\vartheta) = \sup \lbrace \beta_\varphi(\vartheta)\ |\ 1 - \beta_\varphi(\vartheta_0) = \alpha \rbrace,$$ because of $\beta_{\varphi'} = 1 - \beta_{\tilde{\varphi}}$. </details><p>Back to our previous example with $X_1, \dots, X_n$ with known $\sigma^2$, we know that</p>\[p_\mu(x) = (2 \pi \sigma^2)^{-\frac{n}{2}} \exp \Big( -\frac{1}{2\sigma^2}\sum_{i=1}^{n}(x_i - \mu)^2 \Big)\]<p>has a monotone likelihood ratio in $T(X) = \overline{X}_n$. An UMP test with level $\alpha$ is given by</p>\[\tilde{\varphi}(x) = 1_{\lbrace\overline{x}_n &gt; c\rbrace } + \gamma 1_{\lbrace\overline{x}_n = c\rbrace}.\]<p>Since $P_{\mu_0}(T(X) = c) = 0$, then $\gamma = 0$ and we choose $c$ such that</p>\[P_{\mu_0}(\overline{X}_n &gt; c) = \alpha \Longleftrightarrow c = \mu_0 + \frac{\sigma}{\sqrt{n}} u_{1-\alpha}.\]<p>This UMP test</p>\[\tilde{\varphi}(x) = 1_{\lbrace \overline{X}_n &gt; \mu_0 + \frac{\sigma}{\sqrt{n}}u_{1-\alpha} \rbrace }\]<p>is called <strong>the one-sided Gauss test</strong>.</p><p>There is a heuristic how to get to the one-sided Gauss test: since $\overline{X}_n$ is UMVU for $\mu$, a reasonable strategy is to decide for $K$ if $\overline{X}_n$ is “large enough”, so the test shoud be of the form</p>\[\varphi(x) = 1_{\lbrace \overline{X}_n &gt; c \rbrace }.\]<p>Choosing $c$ happens by controlling the error of the 1st kind. For all $\mu \leq \mu_0$ we have</p>\[\begin{aligned} \beta_\varphi(\mu) &amp;= P_\mu(\overline{X}_n &gt; c) \\ &amp;= P_\mu \Big( \frac{\sqrt{n}(\overline{X}_n - \mu) }{\sigma} &gt; \frac{\sqrt{n}(c-\mu)}{\sigma}\Big) \\ &amp;= 1 - \Phi\Big(\frac{\sqrt{n}(c-\mu)}{\sigma}\Big) \\&amp;\leq 1 - \Phi\Big(\frac{\sqrt{n}(c-\mu_0)}{\sigma}\Big). \end{aligned}\]<p>So we need to secure that</p>\[1- \Phi\Big(\frac{\sqrt{n}(c-\mu_0)}{\sigma}\Big) \leq \alpha \Longleftrightarrow c \geq \mu_0 + \frac{\sigma}{\sqrt{n}} u_{1-\alpha}.\]<p>We take $c = \mu_0 + \frac{\sigma}{\sqrt{n}} u_{1-\alpha}$ for an error of the 1st kind to be $\alpha$.</p><p>This method doesn’t tell you anything about optimality, but at least provides a test. Most importantly, it can be applied in more general situations like unknown $\sigma^2$. In this case one can use</p>\[\hat{\sigma}_n^2 = \frac{1}{n-1}\sum_{i=1}^{n}(X_i - \overline{X}_n)^2.\]<p>As above we obtain</p>\[\beta_\varphi(\mu) = P_\mu\Big( \frac{\sqrt{n}(\overline{X}_n - \mu) }{\hat{\sigma}_n} &gt; \frac{\sqrt{n}(c-\mu)}{\hat{\sigma}_n}\Big) = 1 - F_{t_{n-1}}\bigg( \frac{c - \mu}{\sqrt{\hat{\sigma}_n^2 / n}} \bigg),\]<p>where $F_{t_{n-1}}$ denotes the distribution function of $t_{n-1}$. A reasonable choice is</p>\[c = \mu_0 + \frac{\hat{\sigma}_n}{\sqrt{n}}t_{n-1,1-\alpha},\]<p>with the corresponding quantile of a $t_{n-1}$ distribution. The test</p>\[\phi(x) = 1_{\lbrace \overline{x}_n &gt; \mu_0 + \frac{\hat{\sigma}_n}{\sqrt{n}}t_{n-1,1-\alpha} \rbrace}\]<p>is called <strong>the one-sided t-test</strong>.</p><h3 id="two-sided-tests">Two-sided tests</h3><p>There are in general no UMP tests for</p>\[H\colon\vartheta = \vartheta_0 \quad \text{vs} \quad K\colon\vartheta \neq \vartheta_0,\]<p>because these have to be optimal for all</p>\[H'\colon\vartheta = \vartheta_0 \quad \text{vs} \quad K'\colon\vartheta = \vartheta_1\]<p>with $\vartheta_0 \neq \vartheta_1$. In case of monotone likelihood-ratio, the optimal test in this case is</p>\[\varphi(x) = 1_{\lbrace T(x) &gt; c \rbrace} + \gamma(x) 1_{\lbrace T(x) = c\rbrace}\]<p>for $\vartheta_1 &gt; \vartheta_0$ and</p>\[\varphi'(x) = 1_{\lbrace T(x) &lt; c'\rbrace } + \gamma'(x) 1_{\lbrace T(x) = c'\rbrace}\]<p>for $\vartheta_1 &lt; \vartheta_0$. This is not possible.</p><p>There is a theorem for one-parametric exponential family with density</p>\[p_\vartheta(x) = c(\vartheta)h(x)\exp(Q(\vartheta) T(x))\]<p>with increasing $Q$: UMPU test for</p>\[H \colon \vartheta \in [\vartheta_1, \vartheta_2] \quad \text{vs} \quad K\colon\vartheta \notin [\vartheta_1, \vartheta_2]\]<p>is</p>\[\varphi(x) = \left \lbrace \begin{array}{cl} 1, &amp; \text{if } T(x) \notin [c_1, c_2], \\ \gamma_i, &amp; \text{if } T(x) = c_i, \\ 0, &amp; \text{if } T(x) \in (c_1, c_2), \end{array} \right.\]<p>where the constants $c_i, \gamma_i$ determined from</p>\[\beta_\varphi(\vartheta_1) = \beta_\varphi(\vartheta_2) = 1-\alpha.\]<p>Similar results hold for $k$-parametric exponential families.</p><p>Take an example: let $X$ be exponentially distributed random variable: $X \sim \operatorname{Exp}(\vartheta)$ with density</p>\[f_\vartheta(x) = \vartheta e^{-\vartheta x} 1_{[0, \infty)}(x)\]<p>and we test</p>\[H\colon \vartheta \in [1, 2] \quad \text{vs} \quad K\colon\vartheta \notin [1, 2].\]<p>We have $T(x) = x$ and</p>\[\varphi(x) = 1_{\lbrace X \notin [c_1, c_2] \rbrace}.\]<p>It is known that for $X$ distribution function is $F(x) = 1 - e^{-\vartheta x}$, therefore</p>\[\begin{aligned} P_{1}(X \in [c_1, c_2])&amp;=e^{-c_1}-e^{-c_2} = 1-\alpha, \\ P_{2}(X \in [c_1, c_2])&amp;=e^{-2 c_1}-e^{-2 c_2} = 1-\alpha. \end{aligned}\]<p>Solving this for $c_1$ and $c_2$ we get</p>\[c_1 = \ln\frac{2}{2-\alpha}, \quad c_2 = \ln\frac{2}{\alpha}.\]<h3 id="asymptotic-properties-of-tests">Asymptotic properties of tests</h3><p>Let $X_1, \dots , X_m$ i.i.d. $\sim \mathcal{N}(\mu_1, \sigma^2)$ and $Y_1, \dots , Y_n$ i.i.d. $\sim \mathcal{N}(\mu_2, \tau^2)$ are two independent samples. We want to test the hypothesis:</p>\[H\colon \mu_1 \leq \mu_2 \quad \text{vs} \quad K\colon \mu_1 &gt; \mu_2.\]<p>We reject $H$ if $\overline{Y}_n$ is much smaller than $\overline{X}_m$.</p><ul><li>Let $\sigma^2=\tau^2$, but variance is unknown. We know from <a href="https://astralord.github.io/posts/visual-guide-to-statistics-part-i-basics-of-point-estimation/">Part I</a> that</ul>\[\overline{X}_m - \overline{Y}_n=\mathcal{N}\bigg(\mu_1-\mu_2, \sigma^2\bigg( \frac{1}{m}+\frac{1}{n} \bigg)\bigg)\]<p>and <strong>pooled variance</strong>:</p>\[\hat{\sigma}_{m,n}^2=\frac{1}{m+n-2}\Big( \sum_{i=1}^{m}(X_i-\overline{X}_m)^2+\sum_{i=1}^{n}(Y_i-\overline{Y}_n)^2 \Big) \sim \frac{\sigma^2}{m+n-2} \chi_{m+n-2}^2.\]<p>For $\mu_1=\mu_2$ we have</p>\[T_{m,n}=\sqrt{\frac{mn}{m+n}}\frac{\overline{X}_m-\overline{Y}_n}{\hat{\sigma}_{m,n}} \sim t_{m+n-2},\]<p>therefore test</p>\[\varphi_{m,n}(x)=1_{\lbrace T_{m,n} &gt; t_{m+n-2, 1-\alpha}\rbrace }\]<p>is UMPU with significance level $\alpha$. This test is called <strong>two-sample t-test</strong>.</p><ul><li>Let $\sigma^2 \neq \tau^2$, then</ul>\[\overline{X}_m - \overline{Y}_n=\mathcal{N}\bigg(\mu_1-\mu_2, \frac{\sigma^2}{m}+\frac{\tau^2}{n} \bigg).\]<p>Unbiased estimators for variances are</p>\[\hat{s}_{m}^2(X)=\frac{1}{m-1}\sum_{i=1}^{m}(X_i-\overline{X}_m)^2, \quad \hat{s}_{n}^2(Y)=\frac{1}{n-1}\sum_{i=1}^{n}(Y_i-\overline{Y}_n)^2.\]<p>Let also</p>\[\hat{s}_{m, n}^2 = \frac{1}{m}\hat{s}_{m}^2(X) + \frac{1}{n}\hat{s}_{n}^2(Y).\]<p>The distribution of random variable</p>\[T_{m,n}^*=\frac{\overline{X}_m-\overline{Y}_n}{\hat{s}_{m, n}}\]<p>was unknown until recently (so called <a href="https://en.wikipedia.org/wiki/Behrens%E2%80%93Fisher_problem">Behrens-Fisher problem</a>) and can’t be expressed in terms of elementary functions, but from Central Limit Theorem we know that</p>\[\frac{\overline{X}_m-\overline{Y}_n - (\mu_1-\mu_2)}{\hat{s}_{m,n}} \xrightarrow[]{\mathcal{L}} \mathcal{N}(0,1),\]<p>if $m \rightarrow \infty$, $n \rightarrow \infty$ and $\frac{m}{n}\rightarrow \lambda \in (0, \infty)$. Let</p>\[\varphi_{m,n}^*(x)=1_{\lbrace T_{m,n}^* &gt; u_{1-\alpha}\rbrace },\]<p>then</p>\[\begin{aligned} \beta_{\varphi_{m,n}^*}(\mu_1, \mu_2) &amp; =P_{\mu_1, \mu_2}(T_{m,n}^* \leq u_{1-\alpha})\\&amp;=P_{\mu_1, \mu_2}\Big(\frac{\overline{X}_m-\overline{Y}_n - (\mu_1-\mu_2)}{\hat{s}_{m,n}} \leq \frac{- (\mu_1-\mu_2)}{\hat{s}_{m,n}}+ u_{1-\alpha}\Big) \\ &amp; \xrightarrow[m \rightarrow \infty,\ n \rightarrow \infty,\ \frac{m}{n}\rightarrow \lambda]{} \left \lbrace \begin{array}{cl} 0, &amp; \mu_1 &gt; \mu_2, \\ 1-\alpha, &amp; \mu_1=\mu_2, \\ 1, &amp; \mu_1&lt;\mu_2. \end{array} \right. \end{aligned}\]<ul><li>We say that sequence $(\varphi_n)$ has <strong>asymptotic significance level</strong> $\alpha$, if</ul>\[\lim_{n \rightarrow \infty} \inf_{\vartheta \in \Theta_H} \beta_{\varphi_n}(\vartheta) \geq 1-\alpha.\]<ul><li>We say that sequence $(\varphi_n)$ is <strong>consistent</strong>, if</ul>\[\lim_{n \rightarrow \infty} \beta_{\varphi_n}(\vartheta) = 0 \quad \forall \vartheta \in \Theta_K.\]<p>In our example $\varphi_{m,n}^*(x)$ is consistent and has asymptotic significance level $\alpha$.</p><h3 id="likelihood-ratio">Likelihood ratio</h3><p>The common principle of building tests for</p>\[H\colon\vartheta \in \Theta_H \quad \text{vs} \quad K\colon\vartheta \in \Theta_K\]<p>is <strong>likelihood ratio method</strong>. Let $f_n(x^{(n)},\vartheta)$ be density of $P_\vartheta^n$. Then</p>\[\lambda(x^{(n)})=\frac{\sup_{\vartheta \in \Theta_H}f_n(x^{(n)},\vartheta)}{\sup_{\vartheta \in \Theta}f_n(x^{(n)},\vartheta)}\]<p>is <strong>likelihood ratio</strong> and</p>\[\varphi_n(x^{(n)})=1_{\lbrace \lambda(x^{(n)})&lt;c \rbrace }\]<p>is <strong>likelihood ratio test</strong>. It is common to choose $c$, such that</p>\[\sup_{\vartheta \in \Theta_H} P_\vartheta(\lambda(X^{(n)})&lt;c) \leq \alpha.\]<p>Distribution $\lambda(X^{(n)})$ nevertheless can be estimated only asymptotically.</p><p>Before we continue further, we will formulate some conditions. Let $\Theta \subset \mathbb{R}^d$ and there exist $\Delta \subset \mathbb{R}^c$ and twice continuously differentiable function $h:\Delta \rightarrow \Theta$, such that $\Theta_H = h(\Delta)$ and Jacobian of $h$ is matrix of full rank.</p><p>For example, let $X_1, \dots, X_n$ i.i.d. $\sim \mathcal{N}(\mu_1, \sigma^2)$ and $Y_1, \dots, Y_n$ i.i.d. $\sim \mathcal{N}(\mu_2, \sigma^2)$ be two independent samples. Suppose we want to test the equivalency of means:</p>\[H\colon \mu_1 = \mu_2 \quad \text{vs} \quad K\colon \mu_1 \neq \mu_2.\]<p>Then $\Theta \in \mathbb{R}^2 \times \mathbb{R}^+$, $\Delta = \mathbb{R} \times \mathbb{R}^+$ and $h(\mu, \sigma^2) = (\mu, \mu, \sigma^2)$. Jacobian matrix is</p>\[J = \begin{pmatrix} 1 &amp; 0 \\ 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix},\]<p>matrix of full rank.</p><p>Let</p>\[\hat{\eta}_n=\arg\max_{\eta \in \Delta}f_n(X^{(n)},h(\eta)) \quad \text{and} \quad \hat{\theta}_n=\arg\max_{\vartheta \in \Theta}f_n(X^{(n)},\vartheta)\]<p>be maximum-likelihood estimators for families</p>\[\mathcal{P}_h = \lbrace P_{h(\eta)}\ |\ \eta \in \Delta\rbrace \quad \text{and} \quad \mathcal{P}_\vartheta = \lbrace P_\vartheta\ |\ \vartheta \in \Theta \rbrace\]<p>respectively. Also let conditions from <a href="https://astralord.github.io/posts/visual-guide-to-statistics-part-iii-asymptotic-properties-of-estimators/#asymptotic-efficiency-of-maximum-likelihood-estimators">theorem of asymptotic efficiency for maximum-likelihood estimators</a> for both families be satisfied. Then</p>\[T_n=-2\log \lambda(X^{(n)})=2(\log f_n(X^{(n)}, \hat{\theta}_n)-\log f_n(X^{(n)}, h(\hat{\eta}_n))) \xrightarrow[]{\mathcal{L}} \chi_{d-c}^2,\]<p>if $\vartheta \in \Theta_H$.</p><details> <summary>Proof</summary> As before we use notation $$\ell(x, \vartheta) = \log f(x, \vartheta).$$ We start with $$\begin{aligned} T_n^{(1)} &amp; = 2(\log f_n(X^{(n)}, \hat{\theta}_n)-\log f_n(X^{(n)}, \vartheta)) \\ &amp; = 2\sum_{i=1}^{n}\Big(\ell(X_i, \hat{\theta}_n) - \ell(X_i, \vartheta)\Big) \\ &amp; = 2(\hat{\theta}_n - \vartheta)^T \sum_{i=1}^{n} \dot{\ell}(X_i, \vartheta) +(\hat{\theta}_n - \vartheta)^T \sum_{i=1}^{n} \ddot{\ell}(X_i, \widetilde{\vartheta}_n)(\hat{\theta}_n - \vartheta) \\ &amp; = 2 (\hat{\theta}_n - \vartheta)^T \Big( \sum_{i=1}^{n} \dot{\ell}(X_i, \vartheta) + \sum_{i=1}^{n} \ddot{\ell}(X_i, \widetilde{\vartheta}_n)(\hat{\theta}_n - \vartheta) \Big) - (\hat{\theta}_n - \vartheta)^T\sum_{i=1}^{n}\ddot{\ell}(X_i, \widetilde{\vartheta}_n)(\hat{\theta}_n - \vartheta) \end{aligned}$$ for some $\widetilde{\theta}_n \in [\hat{\theta}_n, \vartheta]$. Using the notations from [Part III](https://astralord.github.io/posts/visual-guide-to-statistics-part-iii-asymptotic-properties-of-estimators/#asymptotic-efficiency-of-maximum-likelihood-estimators) we rewrite the first term of equation above: $$\begin{aligned} 2n(\hat{\theta}_n - \vartheta)^T&amp; \underbrace{(\dot{L}_n(\vartheta) - \ddot{L}_n(\tilde{\vartheta})(\hat{\theta}_n - \vartheta))}. \\ &amp; \qquad \qquad\ \color{\Salmon}{ = 0 \text{ (by Mean Theorem)}} \end{aligned}$$ Also $$T_n^{(1)} = -\sqrt{n}(\hat{\theta}_n - \vartheta)^T \ddot{L}_n(\widetilde{\vartheta}_n) \sqrt{n}(\hat{\theta}_n - \vartheta), $$ where $$ \begin{aligned} \sqrt{n}(\hat{\theta}_n - \vartheta)^T &amp; \xrightarrow[]{\mathcal{L}} \mathcal{N}(0, I^{-1}(f(\cdot, \vartheta))), \\ \ddot{L}_n(\widetilde{\vartheta}_n)&amp; \xrightarrow[]{\mathbb{P}} -I(f(\cdot, \vartheta)), \\ \sqrt{n}(\hat{\theta}_n - \vartheta) &amp;\xrightarrow[]{\mathcal{L}} \mathcal{N}(0, I^{-1}(f(\cdot, \vartheta))). \end{aligned}$$ We know that for $X \sim \mathcal{N}_d(0, \Sigma)$ with $\Sigma &gt; 0$ we have $$X^T \Sigma X ~ \sim \mathcal{X}_d^2.$$ Therefore, $$T_n^{(1)} \xrightarrow[]{\mathcal{L}} A \sim \mathcal{X}_d^2.$$ In the same way, $$ T_n^{(2)} = 2 (\log f_n(X^{(n)}, h(\hat{\eta}_n) ) - \log f_n(X^{(n)},h(\eta))) \xrightarrow[]{\mathcal{L}} B \sim \mathcal{X}_c^2. $$ If $H$ is true, then $\vartheta = h(\eta)$ and $$T_n = T_n^{(1)} - T_n^{(2)} \xrightarrow[]{\mathcal{L}} A-B \sim \mathcal{X}_{d-c}^2,$$ which follows from independence of $A-B$ and $B$. </details><p>This statement is called <strong>Wilk’s theorem</strong> and it shows that</p>\[\varphi_n (X^{(n)}) = \left \{ \begin{array}{cl} 1, &amp; -2\log\lambda(X^{(n)}) &gt; \mathcal{X}_{d-c, 1-\alpha}^2, \\ 0, &amp; \text{otherwise} \end{array} \right.\]<p>is a test with asymptotic level $\alpha$. Also, sequence $(\varphi_n)$ is consistent, because</p>\[\begin{aligned} -\frac{2}{n} \log (\lambda(X^{(n)})) &amp; = \frac{2}{n} \sum_{i=1}^{n} \Big( \ell(X_i, \hat{\theta}_n) - \ell(X_i, h(\hat{\eta}_n)) \Big) \\ &amp; \xrightarrow{\mathcal{L}} 2 \mathbb{E}_\vartheta[\ell(X,\vartheta) - \ell(X, h(\eta))] \\ &amp; = 2 KL(\vartheta | h(\eta)) &gt; 0, \end{aligned}\]<p>if $\vartheta \neq h(\eta)$. Hence for $\vartheta \in \Theta_K$</p>\[-2\log(\lambda(X^{(n)}))\xrightarrow{\mathcal{L}} \infty.\]<h3 id="likelihood-ratio-tests">Likelihood-ratio tests</h3><p>Take an example: let $X_{ij} \sim \mathcal{N}(\mu_i, \sigma_i^2)$, $i = 1, \dots, r$ and $j = 1, \dots, n_i$, where $n_i \rightarrow \infty$ with the same speed. We test equivalence of variances:</p>\[H\colon \sigma_1^2 = \dots = \sigma_r^2 \quad \text{vs} \quad K \colon \sigma_i^2 \neq \sigma_j^2 \text{ for some } i \neq j.\]<p>Here $\Theta = \mathbb{R}^r \times (\mathbb{R}^+)^r$, $\Delta = \mathbb{R}^r \times \mathbb{R}^+$ and</p>\[h((x_1, \dots, x_r, y)^T) = (x_1, \dots, x_r, y, \dots, y)^T.\]<p>Maximum-likelihood estimator is</p>\[\hat{\theta}_n = (\overline{X}_{1 \cdot}, \dots, \overline{X}_{r \cdot}, \hat{s}_1^2, \dots, \hat{s}_r^2)\]<p>with</p>\[\overline{X}_{i \cdot} = \frac{1}{n_i} \sum_{j=1}^{n_i}X_{ij} \quad \text{and} \quad \hat{s}_i^2 = \frac{1}{n_i}\sum_{j=1}^{n_i}(X_{ij} -\overline{X}_{i \cdot})^2.\]<p>Then</p>\[f_n(X^{(n)}, \hat{\vartheta}_n) = \prod_{i=1}^{r} (2 \pi e \hat{s}_i^2)^{-\frac{n_i}{2}}.\]<p>Under null hypothesis maximum-likelihood estimator maximizes</p>\[f_n(X^{(n)}, \hat{\eta}_n) = \prod_{i=1}^{r} (2 \pi \sigma^2)^{-\frac{n_i}{2}} \exp \Big( -\frac{1}{2\sigma^2} \sum_{j=1}^{n_i} (X_{ij} - \overline{X}_{i \cdot})^2 \Big ).\]<p>Setting $n = \sum_{i=1}^{r}n_i$, we get</p>\[\hat{\sigma}^2 = \frac{1}{n}\sum_{i=1}^{r} \sum_{j=1}^{n_i} (X_{ij}-X_{i \cdot})^2 = \sum_{i=1}^r \frac{n_i}{n}\hat{s}_i^2.\]<p>Then</p>\[f_n(X^{(n)}, \hat{\eta}_n) = \prod_{i=1}^{r}(2\pi e\hat{\sigma}^2)^{-\frac{n_i}{2}} = (2\pi e \hat{\sigma}^2)^{-\frac{n}{2}}\]<p>and test statistic becomes</p>\[T_n = -2\log \lambda(X^{(n)}) = n \log \hat{\sigma}^2 - \sum_{i=1}^{r} n_i \log \hat{s}_i^2.\]<p>The test</p>\[\varphi_n(X^{(n)}) = \left \{ \begin{array}{cl} 1, &amp; T_n &gt; \mathcal{X}_{r-1, 1-\alpha}^2, \\ 0, &amp; \text{otherwise}. \end{array} \right.\]<p>is called <strong>the Bartlett test</strong>.</p><p><button id="sample-button-brt">Sample</button> <button id="add-button">Add</button> <button id="delete-button">Delete</button> <button id="reset-button-2">Reset</button></p><div id="asymptotic_test"></div><script> d3.select("#asymptotic_test") .style("position", "relative"); function asymptotic_test() { var mus = [], sigmas = [], alpha = 0.05, n = 30, curve_id = -1, std_avg = 0; var smpl_dots = [], tn_dots = [], stds = []; var si_texts = [], sigma_text = null, t_text = null; var colors = ["#65AD69", "#EDA137", "#E86456", "#B19CD9", "#A4D8D8"]; var booked_colors = []; var margin = {top: 30, right: 0, bottom: 20, left: 30}, width = 750 - margin.left - margin.right, height = 430 - margin.top - margin.bottom, fig_height = 250 - margin.top - margin.bottom, fig_width = 350; var svg = d3.select("div#asymptotic_test") .append("svg") .attr("width", width + margin.left + margin.right) .attr("height", height + margin.top + margin.bottom) .append("g") .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); var x = d3.scaleLinear() .domain([-10, 10]) .range([0, fig_width]); var xAxis = svg.append("g") .attr("transform", "translate(0," + fig_height + ")") .call(d3.axisBottom(x)); xAxis.selectAll(".tick text") .attr("font-family", "Arvo"); var xRight = d3.scaleLinear() .domain([0, 20]) .range([1.2 * fig_width, 1.9 * fig_width]); var xAxisRight = svg.append("g") .attr("transform", "translate(0," + fig_height + ")") .call(d3.axisBottom(xRight).ticks(5)); xAxisRight.selectAll(".tick text") .attr("font-family", "Arvo"); var y = d3.scaleLinear() .range([fig_height, 0]) .domain([0, 1]); var yAxis = svg.append("g") .call(d3.axisLeft(y).ticks(4)); yAxis.selectAll(".tick text") .attr("font-family", "Arvo"); var yRight = d3.scaleLinear() .range([fig_height, 0]) .domain([0, 1]); var yAxisRight = svg.append("g") .attr("transform", "translate(" + 1.2 * fig_width + ",0)") .call(d3.axisLeft(yRight).ticks(4)); yAxisRight.selectAll(".tick text") .attr("font-family", "Arvo"); var gauss_curves = []; function addCurve(mu, sigma) { reset(); const k = mus.length; mus.push(mu); sigmas.push(sigma); if (curve_id >= 0) { gauss_curves[curve_id] .transition() .attr("opacity", ".2"); } curve_id = k; var data = gauss_data(mus[k], sigmas[k], -10, 10); var color = "#000"; for (var i = 0; i < colors.length; i += 1) { if (booked_colors.indexOf(colors[i]) < 0) { color = colors[i]; booked_colors.push(color); break; } } gauss_curves.push(svg .append('g') .append("path") .datum(data) .attr("fill", color) .attr("border", 0) .attr("opacity", (k == curve_id) ? ".8" : ".2") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d.x); }) .y(function(d) { return y(d.y); }) ) .on('mouseover', function() { d3.select(this) .transition() .attr("opacity", ".8") .style("cursor", "pointer"); }) .on('mouseout', function() { d3.select(this) .transition() .attr("opacity", (curve_id == k) ? ".8" : ".2"); }) .on('click', function() { gauss_curves[curve_id] .transition() .attr("opacity", ".2"); curve_id = k; d3.select(this) .transition() .attr("opacity", ".8"); muHandler.attr("cx", mu_x(mus[k])); sigmaHandler.attr("cx", sigma_x(sigmas[k])); }) ); } function initData() { addCurve(-1, 1); addCurve(1, 1); } initData(); function updateCurve(mu, sigma) { mus[curve_id] = mu; sigmas[curve_id] = sigma; var data = gauss_data(mus[curve_id], sigmas[curve_id], -10, 10); gauss_curves[curve_id] .datum(data) .transition() .duration(0) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return x(d.x); }) .y(function(d) { return y(d.y); }) ); } function updateMu(mu) { updateCurve(mu, sigmas[curve_id]); } function updateSigma(sigma_sq) { reset(); updateCurve(mus[curve_id], Math.sqrt(sigma_sq)); } function trivialRound(x) { return x; } var mu_x = d3.scaleLinear() .domain([-5, 5]) .range([0, width * 0.4]) .clamp(true); var sigma_x = d3.scaleLinear() .domain([0.15, 2]) .range([0, width * 0.4]) .clamp(true); var muHandler = createSlider(svg, updateMu, mu_x, margin.left, 1.7 * fig_height, "", "#A9A750", mus[curve_id], trivialRound); var sigmaHandler = createSlider(svg, updateSigma, sigma_x, margin.left, 1.9 * fig_height, "", "#A9A750", sigmas[curve_id], trivialRound); d3.select("#asymptotic_test") .append("div") .text("\\(\\mu_i \\)") .style('color', '#696969') .style("font-size", "17px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", margin.left + "px") .style("top", 1.7 * fig_height + 15 + "px"); d3.select("#asymptotic_test") .append("div") .text("\\(\\sigma_i^2 \\)") .style('color', '#696969') .style("font-size", "17px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", margin.left + "px") .style("top", 1.9 * fig_height + 15 + "px"); d3.csv("../../../../assets/chi_sf.csv", function(error, data) { if (error) throw error; const quantiles = [3.84, 5.99, 7.81, 9.49]; var chi_curve0 = svg .append('g') .append("path") .datum(data) .attr("fill", "#348ABD") .attr("border", 0) .attr("opacity", ".8") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d["chi_x0_1"]); }) .y(function(d) { return yRight(d["chi_y0_1"]); }) ); var chi_curve1 = svg .append('g') .append("path") .datum(data) .attr("fill", "#348ABD") .attr("border", 0) .attr("opacity", ".2") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("stroke-linejoin", "round") .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d["chi_x1_1"]); }) .y(function(d) { return yRight(d["chi_y1_1"]); }) ); var u_dot = svg.append('g') .selectAll("dot") .data([{'x': xRight(quantiles[0]), 'y': yRight(0.05)}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#fff") .attr("stroke", "#348ABD") .attr("stroke-width", 2); function updateChi(n) { chi_curve0 .datum(data) .transition() .duration(1200) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d["chi_x0_" + n]); }) .y(function(d) { return yRight(d["chi_y0_" + n]); }) ); chi_curve1 .datum(data) .transition() .duration(1200) .attr("d", d3.line() .curve(d3.curveBasis) .x(function(d) { return xRight(d["chi_x1_" + n]); }) .y(function(d) { return yRight(d["chi_y1_" + n]); }) ); u_dot .transition() .duration(1200) .attr("cx", function (d) { return xRight(quantiles[n-1]); } ) .attr("cy", function (d) { return yRight(0.05); } ) } d3.select("#add-button").on("click", function() { if (gauss_curves.length < colors.length) { var mu = 10 * Math.random() - 5; var sigma = 1; addCurve(mu, sigma); muHandler.attr("cx", mu_x(mus[curve_id])); sigmaHandler.attr("cx", sigma_x(sigmas[curve_id])); updateChi(gauss_curves.length - 1); } }); d3.select("#delete-button").on("click", function() { if (gauss_curves.length > 2) { reset(); booked_color = gauss_curves[curve_id].attr("fill"); booked_color_id = booked_colors.indexOf(booked_color); booked_colors.splice(booked_color_id, 1); gauss_curves[curve_id].remove(); mus.splice(curve_id, 1); sigmas.splice(curve_id, 1); gauss_curves.splice(curve_id, 1); curve_id = Math.max(0, curve_id - 1); gauss_curves[curve_id] .transition() .attr("opacity", ".8"); muHandler.attr("cx", mu_x(mus[curve_id])); sigmaHandler.attr("cx", sigma_x(sigmas[curve_id])); updateChi(gauss_curves.length - 1); for (var i = 0; i < gauss_curves.length; i += 1) { const k = i; gauss_curves[i] .on('mouseover', function() { d3.select(this) .transition() .attr("opacity", ".8"); }) .on('mouseout', function() { d3.select(this) .transition() .attr("opacity", (curve_id == k) ? ".8" : ".2"); }) .on('click', function() { gauss_curves[curve_id] .transition() .attr("opacity", ".2"); curve_id = k; d3.select(this) .transition() .attr("opacity", ".8"); muHandler.attr("cx", mu_x(mus[k])); sigmaHandler.attr("cx", sigma_x(sigmas[k])); }) } } }); }); var avg_dur = 1200; function sample() { clearSamples(); var random_samples = []; var avgs = []; std_avg = 0; for (var k = 0; k < gauss_curves.length; k += 1) { random_samples.push([]); smpl_dots.push([]); var color = gauss_curves[k].attr("fill"); const ystd = -0.1 * (k + 2); var avg = 0; for (var i = 0; i < n; i += 1) { random_samples[k].push(mus[k] + sigmas[k] * randn_bm()); smpl_dots[k].push(svg.append('g') .selectAll("dot") .data([{x: random_samples[k][i], y: 1}]) .enter() .append("circle") .attr("cx", function (d) { return x(d.x); } ) .attr("cy", function (d) { return y(d.y); } ) .attr("r", 3) .style("fill", color) .attr("stroke", "#000") .attr("stroke-width", 1)); smpl_dots[k][i] .transition() .duration(avg_dur) .attr("cx", function (d) { return x(random_samples[k][i]); } ) .attr("cy", function (d) { return y(ystd); } ); avg += random_samples[k][i]; } avg /= n; avgs.push(avg); var std = 0; for (var i = 0; i < n; i += 1) { std += (random_samples[k][i] - avgs[k]) ** 2; } std /= n; stds.push(std); std_avg += std; } std_avg /= gauss_curves.length; var T_n = gauss_curves.length * Math.log(std_avg); for (var i = 0; i < gauss_curves.length; i += 1) { T_n -= Math.log(stds[i]); } T_n *= n; var tn_dot = svg.append('g') .selectAll("dot") .data([{x: T_n, y: 0}]) .enter() .append("circle") .attr("cx", function (d) { return xRight(d.x); } ) .attr("cy", function (d) { return yRight(d.y); } ) .attr("r", 3) .style("fill", "#348ABD") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("opacity", 0); tn_dot .transition() .duration(avg_dur) .attr("opacity", "1"); tn_dots.push(tn_dot); updateSiTexts(); updateStatTexts(); } d3.select("#sample-button-brt").on("click", function() { sample(); }); function clearSamples() { for (var k = 0; k < smpl_dots.length; k += 1) { for (var i = 0; i < smpl_dots[k].length; i += 1) { smpl_dots[k][i].remove(); } } smpl_dots = []; stds = []; clearSiTexts(); clearStatTexts(); } function reset() { clearSamples(); for (var i = 0; i < tn_dots.length; i += 1) { tn_dots[i].remove(); } tn_dots = []; } d3.select("#reset-button-2").on("click", function() { reset(); }); d3.select("#asymptotic_test") .append("div") .text("\\(\\alpha \\)") .style('color', '#000') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.2 * fig_width + 5 + margin.left + "px") .style("top", 15 + "px"); d3.select("#asymptotic_test") .append("div") .text("\\(\\chi^2_{r-1, 1-\\alpha} \\)") .style('color', '#000') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.9 * fig_width + 5 + margin.left + "px") .style("top", fig_height + 15 + "px"); var labels_x = 250; var labels_y = 0; svg.append("path") .attr("stroke", "#348ABD") .attr("stroke-width", 4) .attr("opacity", ".8") .datum([{x: labels_x + fig_width, y: labels_y}, {x: labels_x + fig_width + 25, y: labels_y}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); svg.append("path") .attr("stroke", "#000") .attr("stroke-width", 1) .datum([{x: labels_x + fig_width, y: labels_y - 2}, {x: labels_x + fig_width + 25, y: labels_y - 2}]) .attr("d", d3.line() .x(function(d) { return d.x; }) .y(function(d) { return d.y; })); d3.select("#asymptotic_test") .append("div") .text("\\(1-F_{\\chi^2_{r-1}}(x) \\)") .style('color', '#348ABD') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", labels_x + fig_width + margin.left + 30 + "px") .style("top", labels_y + 15 + "px"); svg.append('g') .selectAll("dot") .data([{'x': labels_x + fig_width + 13, 'y': labels_y + 20}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 3) .style("fill", "#348ABD") .attr("stroke", "#000") .attr("stroke-width", 1); d3.select("#asymptotic_test") .append("div") .text("\\(T_n \\)") .style('color', '#348ABD') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", labels_x + fig_width + margin.left + 30 + "px") .style("top", labels_y + 35 + "px"); svg .append("text") .attr("text-anchor", "start") .attr("y", 5) .attr("x", 0.7 * fig_width ) .attr("font-family", "Arvo") .text("X distributions") .style("font-size", "14px") .style("fill", "#696969"); d3.select("#asymptotic_test") .append("div") .text("\\(\\hat{\\sigma}^2 \\)") .style('color', '#000') .style("font-size", "12px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.2 * fig_width + 100 + margin.left + "px") .style("top", fig_height + 58 + "px"); d3.select("#asymptotic_test") .append("div") .text("\\(T_n \\)") .style('color', '#000') .style("font-size", "12px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.2 * fig_width + 100 + margin.left + "px") .style("top", fig_height + 79 + "px"); d3.select("#asymptotic_test") .append("div") .text("\\(\\hat{s}_i^2: \\)") .style('color', '#000') .style("font-size", "12px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.2 * fig_width + 25 + margin.left + "px") .style("top", fig_height + 58 + "px"); svg .append("text") .attr("text-anchor", "start") .attr("y", 1.8 * fig_height) .attr("x", 1.2 * fig_width + 5) .attr("font-family", "Arvo") .text("Significance level: 0.05") .style("font-size", "14px") .style("fill", "#348ABD"); function createSiTexts() { for (var i = 0; i < 5; i += 1) { si_texts.push(svg.append("text") .attr("text-anchor", "start") .attr("y", y(-0.1 * (i + 2.2))) .attr("x", 1.2 * fig_width + 50) .attr("font-family", "Arvo") .style("font-size", "12px") .text("")); } } function updateSiTexts() { for (var i = 0; i < gauss_curves.length; i += 1) { var color = gauss_curves[i].attr("fill"); var rounded_si = Math.round(1000 * stds[i]) / 1000; si_texts[i] .transition() .duration(avg_dur) .text(rounded_si.toString()) .style("fill", color); } } function clearSiTexts() { for (var i = 0; i < si_texts.length; i += 1) { si_texts[i] .transition() .duration(avg_dur) .text(""); } } function createStatTexts() { sigma_text = svg.append("text") .attr("text-anchor", "start") .attr("y", y(-0.22)) .attr("x", 1.2 * fig_width + 115) .attr("font-family", "Arvo") .style("font-size", "12px") .text(""); t_text = svg.append("text") .attr("text-anchor", "start") .attr("y", y(-0.32)) .attr("x", 1.2 * fig_width + 115) .attr("font-family", "Arvo") .style("font-size", "12px") .text("") .style("fill", "#348ABD"); } function updateStatTexts() { var sigma_num = Math.round(1000 * std_avg) / 1000; sigma_text .transition() .duration(avg_dur) .text("= " + sigma_num); var t_num = xRight.invert(tn_dots[tn_dots.length - 1].attr("cx")); t_num = Math.round(1000 * t_num) / 1000; t_text .transition() .duration(avg_dur) .text("= " + t_num); } function clearStatTexts() { if (sigma_text != null) { sigma_text .transition() .text(""); t_text .transition() .text(""); } } createSiTexts(); createStatTexts(); } asymptotic_test(); </script><p><img data-proofer-ignore data-src="." alt="" /> <em>Fig. 3. Visualization of Bartlett test. Up to five normally distributed samples can be added, each with $n_i=30$. Significance level $\alpha$ is fixed at $0.05$. Choose different variations of $\sigma_i^2$ to observe how it affects test statistic $T_n$.</em></p><p>Take another example: suppose we have two discrete variables $A$ and $B$ (e.g. such as gender, age, education or income), where $A$ can take $r$ values and $B$ can take $s$ values. Further suppose that $n$ individuals are randomly sampled. A <strong>contingency table</strong> can be created to display the joint sample distribution of $A$ and $B$.</p><div class="table-wrapper"><table><thead><tr><th> <th>$1$<th>$\cdots$<th>$s$<th>Sum<tbody><tr><td>$1$<td>$X_{11}$<td>$\cdots$<td>$X_{1s}$<td>$X_{1\cdot} = \sum_{j=1}^n X_{1j}$<tr><td>$\vdots$<td>$\vdots$<td>$\vdots$<td>$\vdots$<td>$\vdots$<tr><td>$r$<td>$X_{r1}$<td>$\cdots$<td>$X_{rs}$<td>$X_{r\cdot}$<tr><td><strong>Sum</strong><td>$X_{\cdot1}$<td>$\cdots$<td>$X_{\cdot s}$<td>$n$</table></div><p>We model vector $X$ with multinomial distribution:</p>\[(X_1, \dots X_n)^T \sim \mathcal{M}(n, p_{11}, \dots, p_{rs}),\]<p>where $\sum_{ij} p_{ij} = 1$. Joint density is</p>\[f_n(x^{(n)}, p) = P_p(X_{ij}=x_{ij}) = \frac{n!}{\prod_{i,j=1}^{r,s} x_{ij}!} \prod_{i,j=1}^{r,s} (p_{ij})^{x_{ij}},\]<p>where $x_{ij} = \lbrace 0, \dots, n\rbrace$ and $\sum_{i,j=1}^{r,s} x_{ij} = n$. Maximum-likelihood estimator is</p>\[\hat{p}_{ij} = \frac{X_{ij}}{n}\]<p>(in analogy to binomial distribution) and</p>\[f_n(X^{(n)}, \hat{p}) = \frac{n!}{\prod_{i,j=1}^{r,s} X_{ij}!} \prod_{i,j=1}^{r,s} \Big(\frac{X_{ij}}{n}\Big)^{X_{ij}}\]<p>Suppose we want to test independence between $A$ and $B$:</p>\[H\colon p_{ij} = p_i q_j \ \forall i,j \quad \text{vs} \quad K\colon p_{ij} \neq p_i q_j \text{ for some } i \neq j,\]<p>where $p_i = p_{i \cdot} = \sum_{j=1}^{s}p_{ij}$ and $q_j = p_{\cdot, j} = \sum_{i=1}^{r}p_{ij}$. Here $d = rs-1$, $c = r + s - 2$ and $d-c = (r-1)(s-1)$. If null hypothesis is true, then</p>\[f_n(X^{(n)}, p, q) = \frac{n!}{\prod_{i,j=1}^{r,s} X_{ij}!} \prod_{i,j=1}^{r,s} (p_i q _j)^{X_{ij}} = \frac{n!}{\prod_{i,j=1}^{r,s} X_{ij}!} \prod_{i}^{r} p_i^{X_{i \cdot}} \prod_{j=1}^{s} q_j ^ {X_{\cdot j}}.\]<p>Maximum-likelihood estimators are</p>\[\hat{p}_i = \frac{X_{i \cdot}}{n} \quad \text{and} \quad \hat{q}_j = \frac{X_{\cdot j}}{n},\]<p>and likelihood function is</p>\[f_n(X^{(n)}, \hat{p}, \hat{q}) = \frac{n!}{\prod_{i,j=1}^{r,s} X_{ij}!} \prod_{i,j=1}^{r,s} \Big( \frac{X_{i \cdot} X_{\cdot j}}{n^2} \Big)^{X_{ij}}.\]<p>We get</p>\[T_n = -2 \log \lambda(X^{(n)}) = 2 \sum_{i=1}^r \sum_{j=1}^s X_{ij} \log \Big( \frac{nX_{ij}}{ X_{i \cdot} X_{\cdot j} } \Big)\]<p>and</p>\[\varphi_n(X^{(n)}) = \left \{ \begin{array}{cl} 1, &amp; T_n &gt; \mathcal{X}_{(r-1)(s-1), 1-\alpha}^2, \\ 0, &amp; \text{otherwise}, \end{array} \right.\]<p>which is called <strong>chi-square independence test</strong>. Using Taylor expansion with Law of Large Number we can get asymptotic equivalent</p>\[\tilde{T}_n = \sum_{i=1}^{r} \sum_{j=1}^s \frac{\Big(X_{ij} -\frac{X_{i \cdot} X_{\cdot j}}{n}\Big)^2}{\frac{X_{i \cdot} X_{\cdot j}}{n}}.\]<p>Usually,</p>\[V_n = \sqrt{\frac{\tilde{T}_n}{n (\min(r, s) - 1)}}\]<p>is used as dependency measure between $A$ and $B$, because under both null hypothesis and alternative convergence takes place</p>\[V_n^2 \xrightarrow{\mathbb{P}} \frac{1}{\min(r, s) - 1}\sum_{i=1}^{r} \sum_{j=1}^s \frac{(p_{ij} - p_{i \cdot}p_{\cdot j} )^2}{p_{i \cdot}p_{\cdot j}}\]<div id="htmp"></div><script> d3.select("#htmp") .style("position", "relative"); function plt_heatmap() { var margin = {top: 30, right: 30, bottom: 5, left: 50}, width = 750 - margin.left - margin.right, height = 300 - margin.top - margin.bottom, fig_width = 300, fig_height = 240; var svg = d3.select("#htmp") .append("svg") .attr("width", width + margin.left + margin.right) .attr("height", height + margin.top + margin.bottom) .append("g") .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); var r = 4, s = 5; var rows = [], columns = []; for (var i = 0; i < r; i += 1) { rows.push(i + 1); } for (var i = 0; i < s; i += 1) { columns.push(i + 1); } var x = d3.scaleBand() .range([ 0, fig_width ]) .domain(columns) .padding(0.01); svg.append("g") .attr("transform", "translate(0," + fig_height + ")") .call(d3.axisBottom(x)) .selectAll(".tick text") .attr("font-family", "Arvo"); var y = d3.scaleBand() .range([ fig_height, 0 ]) .domain(rows) .padding(0.01); svg.append("g") .call(d3.axisLeft(y)) .selectAll(".tick text") .attr("font-family", "Arvo"); var xRight = d3.scaleLinear() .domain([0, 50]) .range([1.2 * fig_width, 2.2 * fig_width]); svg.append("g") .attr("transform", "translate(0," + 0.5 * fig_height + ")") .call(d3.axisBottom(xRight)) .selectAll(".tick text") .attr("font-family", "Arvo"); var yRight = d3.scaleLinear() .range([0.5 * fig_height, 0.2 * fig_height]) .domain([0, 1]); svg.append("g") .attr("transform", "translate(" + 1.2 * fig_width + ",0)") .call(d3.axisLeft(yRight).ticks(1)) .selectAll(".tick text") .attr("font-family", "Arvo"); var color = d3.scaleLinear() .range(["white", "#65AD69"]) .domain([1, 25]); var data = []; for (var i = 0; i < s; i += 1) { for (var j = 0; j < r; j += 1) { var value = 1 + Math.round(19 * Math.random()); data.push({'i': i + 1, 'j': j + 1, 'value': value}); } } var t_n = 0, v_n = 0; var tn_text = svg.append("text") .attr("text-anchor", "start") .attr("y", 0.8 * fig_height + 3) .attr("x", 1.4 * fig_width + 20) .attr("font-family", "Arvo") .attr("font-weight", 700) .style("font-size", "13px") .style("fill", "#348ABD"); var vn_text = svg.append("text") .attr("text-anchor", "start") .attr("y", 0.8 * fig_height + 3) .attr("x", 1.8 * fig_width + 20) .attr("font-family", "Arvo") .attr("font-weight", 700) .style("font-size", "13px") .style("fill", "#EDA137"); function updateTn() { t_n = 0; v_n = 0; var n = 0, xi = [0, 0, 0, 0], xj = [0, 0, 0, 0, 0]; for (var i = 0; i < s; i += 1) { for (var j = 0; j < r; j += 1) { var xij = data[i * r + j]['value']; n += xij; xj[i] += xij; xi[j] += xij; } } for (var i = 0; i < s; i += 1) { for (var j = 0; j < r; j += 1) { var xij = data[i * r + j]['value']; if (xij > 0) { t_n += xij * Math.log(n * xij / (xi[j] * xj[i])); } if ((xi[j] > 0) && (xj[i] > 0)) { v_n += (xij - xi[j] * xj[i] / n) ** 2 / (xi[j] * xj[i] / n); } } } v_n = Math.sqrt(v_n / ((Math.min(r, s) - 1) * n) ); tn_text .transition() .duration(500) .text(" = " + Math.round(1000 * t_n) / 1000); vn_text .transition() .duration(500) .text(" = " + Math.round(1000 * v_n) / 1000); tn_dot .data([{'x': xRight(t_n), 'y': yRight(t_n > c ? 1 : 0)}]) .transition() .duration(500) .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) } var tooltip = d3.select("#htmp") .append("div") .style("opacity", 0) .attr("class", "tooltip") .style("background-color", "white") .style("border", "solid") .style("border-width", "2px") .style("border-radius", "10px") .style("padding", "5px"); var mouseover = function(d) { tooltip .style("opacity", 1); d3.select(this) .style("stroke", "black") .style("opacity", 1); }; var mousemove = function(d) { tooltip .html(d.value) .style("left", (d3.mouse(this)[0] + 70) + "px") .style("top", (d3.mouse(this)[1]) + "px"); }; var mouseleave = function(d) { tooltip .style("opacity", 0); d3.select(this) .style("stroke", "none") .style("opacity", 0.8); }; var onclick = function(d) { if (d3.event.ctrlKey || d3.event.metaKey) { d['value'] = Math.max(d['value'] - 1, 0); } else { d['value'] += 1; } updateTn(); d3.select(this) .style("fill", function(d) { return color(d['value'])} ); mousemove(d); }; var c = 21.026; var phi_data_0 = [{'x': 0, 'y': 0}, {'x': c, 'y': 0}]; var phi_data_1 = [{'x': c, 'y': 1}, {'x': 50, 'y': 1}]; var phi_data_dash = [{'x': c, 'y': 0}, {'x': c, 'y': 1}]; var phi_curve_0 = svg .append('g') .append("path") .datum(phi_data_0) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 2.5) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xRight(d['x']); }) .y(function(d) { return yRight(d['y']); }) ); var phi_curve_1 = svg .append('g') .append("path") .datum(phi_data_1) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 2.5) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xRight(d['x']); }) .y(function(d) { return yRight(d['y']); }) ); var phi_curve_dash = svg .append('g') .append("path") .datum(phi_data_dash) .attr("border", 1) .attr("opacity", "1") .attr("stroke", "#348ABD") .attr("stroke-width", 1) .style("stroke-dasharray", ("3, 3")) .attr("stroke-linejoin", "round") .attr("d", d3.line() .x(function(d) { return xRight(d['x']); }) .y(function(d) { return yRight(d['y']); }) ); var phi_dot = svg.append('g') .selectAll("dot") .data([{'x': xRight(c), 'y': yRight(1)}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 4) .style("fill", "#fff") .attr("stroke", "#348ABD") .attr("stroke-width", 2); var tn_dot = svg.append('g') .selectAll("dot") .data([{'x': xRight(t_n), 'y': yRight(t_n > c ? 1 : 0)}]) .enter() .append("circle") .attr("cx", function (d) { return d.x; } ) .attr("cy", function (d) { return d.y; } ) .attr("r", 3) .style("fill", "#348ABD") .attr("stroke", "#000") .attr("stroke-width", 1) .attr("opacity", 1); updateTn(); d3.select("#htmp") .append("div") .text("\\(X_{i \\cdot} \\)") .style('color', '#000') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", margin.left - 35 + "px") .style("top", 0.5 * fig_height + margin.top - 10 + "px"); d3.select("#htmp") .append("div") .text("\\(X_{\\cdot j} \\)") .style('color', '#000') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 0.5 * fig_width + margin.left - 5 + "px") .style("top", fig_height + margin.top + 25 + "px"); d3.select("#htmp") .append("div") .text("\\(T_n \\)") .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 2.25 * fig_width + margin.left + "px") .style("top", 0.6 * fig_height + "px"); d3.select("#htmp") .append("div") .text("\\(T_n \\)") .style('color', '#348ABD') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.4 * fig_width + margin.left + "px") .style("top", 0.8 * fig_height + 15 + "px"); d3.select("#htmp") .append("div") .text("\\(\\chi_{12, 0.95}^2 \\)") .style('color', '#348ABD') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", xRight(c) + 40 + "px") .style("top", 0.5 * fig_height + 45 + "px"); d3.select("#htmp") .append("div") .text("\\(V_n \\)") .style('color', '#EDA137') .style("font-size", "15px") .attr("font-family", "Arvo") .style("position", "absolute") .style("left", 1.8 * fig_width + margin.left + "px") .style("top", 0.8 * fig_height + 15 + "px"); var heatmap = svg.selectAll() .data(data) .enter() .append("rect") .attr("x", function(d) { return x(d['i']) }) .attr("y", function(d) { return y(d['j']) }) .attr("rx", 8) .attr("ry", 8) .attr("width", x.bandwidth() ) .attr("height", y.bandwidth() ) .style("fill", function(d) { return color(d['value'])} ) .style("stroke-width", 1) .style("stroke", "none") .style("opacity", 0.8) .on("mouseover", mouseover) .on("mousemove", mousemove) .on("mouseleave", mouseleave) .on("click", onclick); } plt_heatmap(); </script><p><img data-proofer-ignore data-src="." alt="" /> <em>Fig. 4. Visualization for chi-square independence test with $r=4$ and $s=5$. Significance level $\alpha$ is fixed at $0.05$. Click on the cell of contingency table to increase $X_{ij}$ value, and CTRL + click to decrease (or ⌘ + click for Mac OS).</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/statistics/'>Statistics</a>, <a href='/categories/visual-guide/'>Visual Guide</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/statistics/" class="post-tag no-text-decoration" >statistics</a> <a href="/tags/hypothesis/" class="post-tag no-text-decoration" >hypothesis</a> <a href="/tags/significance-level/" class="post-tag no-text-decoration" >significance level</a> <a href="/tags/power-of-a-test/" class="post-tag no-text-decoration" >power of a test</a> <a href="/tags/neyman-pearson-test/" class="post-tag no-text-decoration" >neyman-pearson test</a> <a href="/tags/ump-test/" class="post-tag no-text-decoration" >ump-test</a> <a href="/tags/confidence-interval/" class="post-tag no-text-decoration" >confidence interval</a> <a href="/tags/one-sided-gauss-test/" class="post-tag no-text-decoration" >one-sided gauss test</a> <a href="/tags/one-sided-t-test/" class="post-tag no-text-decoration" >one-sided t-test</a> <a href="/tags/two-sample-t-test/" class="post-tag no-text-decoration" >two-sample t-test</a> <a href="/tags/likelihood-ratio-test/" class="post-tag no-text-decoration" >likelihood-ratio test</a> <a href="/tags/wilks-theorem/" class="post-tag no-text-decoration" >wilks theorem</a> <a href="/tags/bartlett-test/" class="post-tag no-text-decoration" >bartlett test</a> <a href="/tags/chi-square-independence-test/" class="post-tag no-text-decoration" >chi-square independence test</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Visual Guide to Statistics. Part IV: Foundations of Testing - AstraBlog&url=https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Visual Guide to Statistics. Part IV: Foundations of Testing - AstraBlog&u=https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Visual Guide to Statistics. Part IV: Foundations of Testing - AstraBlog&url=https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://astralord.github.io/posts/visual-guide-to-statistics-part-iv-foundations-of-testing/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/building-aligned-intelligence-systems-part-i-creating-gpt-assistant/">Building Aligned Intelligence System. Part I: Creating GPT Assistant</a><li><a href="/posts/exploring-parallel-strategies-with-jax/">Exploring Parallel Strategies with Jax</a><li><a href="/posts/building-aligned-intelligence-systems-part-ii-applying-large-language-models/">Building Aligned Intelligence System. Part II. Improving Large Language Models</a><li><a href="/posts/visual-guide-to-statistics-part-i-basics-of-point-estimation/">Visual Guide to Statistics. Part I: Basics of Point Estimation</a><li><a href="/posts/visual-guide-to-statistics-part-ii-bayesian-statistics/">Visual Guide to Statistics. Part II: Bayesian Statistics</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/statistics/">statistics</a> <a class="post-tag" href="/tags/jax/">jax</a> <a class="post-tag" href="/tags/parameter-estimation/">parameter estimation</a> <a class="post-tag" href="/tags/asymptotic-efficiency/">asymptotic efficiency</a> <a class="post-tag" href="/tags/bartlett-test/">bartlett test</a> <a class="post-tag" href="/tags/bayes-estimator/">bayes estimator</a> <a class="post-tag" href="/tags/bayesian-inference/">bayesian inference</a> <a class="post-tag" href="/tags/central-limit-theorem/">central limit theorem</a> <a class="post-tag" href="/tags/chain-of-thought/">chain-of-thought</a> <a class="post-tag" href="/tags/chatgpt/">chatgpt</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/visual-guide-to-statistics-part-i-basics-of-point-estimation/"><div class="card-body"> <span class="timeago small" >Mar 21, 2022<i class="unloaded">2022-03-21T06:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Visual Guide to Statistics. Part I: Basics of Point Estimation</h3><div class="text-muted small"><p> This series of posts is a guidance for those who already have knowledge in probability theory and would like to become familiar with mathematical statistics. Basically, these are notes from lect...</p></div></div></a></div><div class="card"> <a href="/posts/visual-guide-to-statistics-part-ii-bayesian-statistics/"><div class="card-body"> <span class="timeago small" >Mar 21, 2022<i class="unloaded">2022-03-21T06:11:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Visual Guide to Statistics. Part II: Bayesian Statistics</h3><div class="text-muted small"><p> Part II introduces different approach to parameters estimation called Bayesian statistics. Basic definitions We noted in the previous part that it is extremely unlikely to get a uniformly bes...</p></div></div></a></div><div class="card"> <a href="/posts/visual-guide-to-statistics-part-iii-asymptotic-properties-of-estimators/"><div class="card-body"> <span class="timeago small" >Apr 12, 2022<i class="unloaded">2022-04-12T06:00:00+03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Visual Guide to Statistics. Part III: Asymptotic Properties of Estimators</h3><div class="text-muted small"><p> A minimal condition for a good estimator is that it is getting closer to estimated parameter with growing size of sample vector. In this post we will focus on asymptotic properties of estimators...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/visual-guide-to-statistics-part-iii-asymptotic-properties-of-estimators/" class="btn btn-outline-primary" prompt="Older"><p>Visual Guide to Statistics. Part III: Asymptotic Properties of Estimators</p></a> <a href="/posts/applying-graph-neural-networks-to-kaggle-competition/" class="btn btn-outline-primary" prompt="Newer"><p>Applying Graph Neural Networks to Kaggle Competition</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/astralord">Aleksandr Samarin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/statistics/">statistics</a> <a class="post-tag" href="/tags/jax/">jax</a> <a class="post-tag" href="/tags/parameter-estimation/">parameter estimation</a> <a class="post-tag" href="/tags/asymptotic-efficiency/">asymptotic efficiency</a> <a class="post-tag" href="/tags/bartlett-test/">bartlett test</a> <a class="post-tag" href="/tags/bayes-estimator/">bayes estimator</a> <a class="post-tag" href="/tags/bayesian-inference/">bayesian inference</a> <a class="post-tag" href="/tags/central-limit-theorem/">central limit theorem</a> <a class="post-tag" href="/tags/chain-of-thought/">chain of thought</a> <a class="post-tag" href="/tags/chatgpt/">chatgpt</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://astralord.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
